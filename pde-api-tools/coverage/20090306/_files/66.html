<HTML><HEAD><META CONTENT="text/html; charset=UTF-8" HTTP-EQUIV="Content-Type"/><TITLE>EMMA Coverage Report</TITLE><STYLE TYPE="text/css"> TABLE,TD,TH {border-style:solid; border-color:black;} TD,TH {background:white;margin:0;line-height:100%;padding-left:0.5em;padding-right:0.5em;} TD {border-width:0 1px 0 0;} TH {border-width:1px 1px 1px 0;} TR TD.h {color:red;} TABLE {border-spacing:0; border-collapse:collapse;border-width:0 0 1px 1px;} P,H1,H2,H3,TH {font-family:verdana,arial,sans-serif;font-size:10pt;} TD {font-family:courier,monospace;font-size:10pt;} TABLE.hdft {border-spacing:0;border-collapse:collapse;border-style:none;} TABLE.hdft TH,TABLE.hdft TD {border-style:none;line-height:normal;} TABLE.hdft TH.tl,TABLE.hdft TD.tl {background:#6699CC;color:white;} TABLE.hdft TD.nv {background:#6633DD;color:white;} .nv A:link {color:white;} .nv A:visited {color:white;} .nv A:active {color:yellow;} TABLE.hdft A:link {color:white;} TABLE.hdft A:visited {color:white;} TABLE.hdft A:active {color:yellow;} .in {color:#356085;} TABLE.s TD {padding-left:0.25em;padding-right:0.25em;} TABLE.s TD.l {padding-left:0.25em;padding-right:0.25em;text-align:right;background:#F0F0F0;} TABLE.s TR.z TD {background:#FF9999;} TABLE.s TR.p TD {background:#FFFF88;} TABLE.s TR.c TD {background:#CCFFCC;} A:link {color:#0000EE;text-decoration:none;} A:visited {color:#0000EE;text-decoration:none;} A:hover {color:#0000EE;text-decoration:underline;} TABLE.cn {border-width:0 0 1px 0;} TABLE.s {border-width:1px 0 1px 1px;} TD.h {color:red;border-width:0 1px 0 0;} TD.f {border-width:0 1px 0 1px;} TD.hf {color:red;border-width:0 1px 0 1px;} TH.f {border-width:1px 1px 1px 1px;} TR.cis TD {background:#F0F0F0;} TR.cis TD {border-width:1px 1px 1px 0;} TR.cis TD.h {color:red;border-width:1px 1px 1px 0;} TR.cis TD.f {border-width:1px 1px 1px 1px;} TR.cis TD.hf {color:red;border-width:1px 1px 1px 1px;} TD.b {border-style:none;background:transparent;line-height:50%;}  TD.bt {border-width:1px 0 0 0;background:transparent;line-height:50%;} TR.o TD {background:#F0F0F0;}TABLE.it {border-style:none;}TABLE.it TD,TABLE.it TH {border-style:none;}</STYLE></HEAD><BODY><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="tl"><A HREF="http://www.eclemma.org/">EMMA</A> Coverage Report (generated Fri Mar 06 10:39:05 EST 2009)</TH></TR><TR><TD CLASS="nv">[<A HREF="../index.html">all classes</A>][<A HREF="9.html">org.eclipse.pde.api.tools.internal.builder</A>]</TD></TR></TABLE><H2>COVERAGE SUMMARY FOR SOURCE FILE [<SPAN CLASS="in">ReferenceExtractor.java</SPAN>]</H2><TABLE CELLSPACING="0" WIDTH="100%"><TR><TH>name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD>ReferenceExtractor.java</TD><TD>100 % (7/7)</TD><TD>86 % (61/71)</TD><TD>84 % (1652/1969)</TD><TD>85 % (434/508)</TD></TR></TABLE><H3>COVERAGE BREAKDOWN BY CLASS AND METHOD</H3><TABLE CLASS="cn" CELLSPACING="0" WIDTH="100%"><TR><TH CLASS="f">name</TH><TH>class, %</TH><TH>method, %</TH><TH>block, %</TH><TH>line, %</TH></TR><TR><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD><TD CLASS="b"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#0">ReferenceExtractor$LineInfo</A></TD><TD>100 % (1/1)</TD><TD CLASS="h">50 % (2/4)</TD><TD CLASS="h">26 % (16/62)</TD><TD CLASS="h">38 % (5/13)</TD></TR><TR><TD CLASS="f"><A HREF="#1">equals (Object): boolean</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/25)</TD><TD CLASS="h">0 %  (0/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2">toString (): String</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/21)</TD><TD CLASS="h">0 %  (0/3)</TD></TR><TR><TD CLASS="f"><A HREF="#0">ReferenceExtractor$LineInfo (int, Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (9/9)</TD><TD>100 % (4/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4">compareTo (Object): int</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (7/7)</TD><TD>100 % (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#5">ReferenceExtractor$LocalLineNumberMarker</A></TD><TD>100 % (1/1)</TD><TD CLASS="h">33 % (1/3)</TD><TD CLASS="h">26 % (9/34)</TD><TD CLASS="h">44 % (4/9)</TD></TR><TR><TD CLASS="f"><A HREF="#6">equals (Object): boolean</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/22)</TD><TD CLASS="h">0 %  (0/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#7">hashCode (): int</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/3)</TD><TD CLASS="h">0 %  (0/1)</TD></TR><TR><TD CLASS="f"><A HREF="#5">ReferenceExtractor$LocalLineNumberMarker (int, int): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (9/9)</TD><TD>100 % (4/4)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#9">ReferenceExtractor$LabelInfo</A></TD><TD>100 % (1/1)</TD><TD CLASS="h">50 % (1/2)</TD><TD CLASS="h">30 % (9/30)</TD><TD CLASS="h">57 % (4/7)</TD></TR><TR><TD CLASS="f"><A HREF="#a">toString (): String</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/21)</TD><TD CLASS="h">0 %  (0/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#9">ReferenceExtractor$LabelInfo (Reference, Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (9/9)</TD><TD>100 % (4/4)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#c">ReferenceExtractor$ClassFileMethodVisitor</A></TD><TD>100 % (1/1)</TD><TD>93 % (14/15)</TD><TD>83 % (489/588)</TD><TD>85 % (144/169)</TD></TR><TR><TD CLASS="f"><A HREF="#d">toString (): String</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/25)</TD><TD CLASS="h">0 %  (0/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#e">visitLabel (Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD CLASS="h">45 % (25/55)</TD><TD CLASS="h">54 % (7/13)</TD></TR><TR><TD CLASS="f"><A HREF="#f">visitLocalVariable (String, String, String, Label, Label, int): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD CLASS="h">65 % (81/125)</TD><TD CLASS="h">63 % (22/35)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#c">ReferenceExtractor$ClassFileMethodVisitor (ReferenceExtractor, MethodVisitor,...</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (32/32)</TD><TD>100 % (9/9)</TD></TR><TR><TD CLASS="f"><A HREF="#11">getTypeFromDescription (String): Type</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (37/37)</TD><TD>100 % (9/9)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#12">visitCode (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (3/3)</TD><TD>100 % (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#13">visitEnd (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (16/16)</TD><TD>100 % (6/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#14">visitFieldInsn (int, String, String, String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (33/33)</TD><TD>100 % (14/14)</TD></TR><TR><TD CLASS="f"><A HREF="#15">visitLdcInsn (Object): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (27/27)</TD><TD>100 % (8/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#16">visitLineNumber (int, Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (9/9)</TD><TD>100 % (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#17">visitMethodInsn (int, String, String, String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (117/117)</TD><TD>100 % (30/30)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#18">visitMultiANewArrayInsn (String, int): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (17/17)</TD><TD>100 % (5/5)</TD></TR><TR><TD CLASS="f"><A HREF="#19">visitTryCatchBlock (Label, Label, Label, String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (23/23)</TD><TD>100 % (7/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1a">visitTypeInsn (int, String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (54/54)</TD><TD>100 % (18/18)</TD></TR><TR><TD CLASS="f"><A HREF="#1b">visitVarInsn (int, int): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (15/15)</TD><TD>100 % (4/4)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#1c">ReferenceExtractor$ClassFileSignatureVisitor</A></TD><TD>100 % (1/1)</TD><TD>89 % (17/19)</TD><TD>87 % (162/187)</TD><TD>85 % (51/60)</TD></TR><TR><TD CLASS="f"><A HREF="#1d">visitExceptionType (): SignatureVisitor</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/5)</TD><TD CLASS="h">0 %  (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1e">visitInnerClassType (String): void</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/4)</TD><TD CLASS="h">0 %  (0/2)</TD></TR><TR><TD CLASS="f"><A HREF="#1f">visitBaseType (char): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD CLASS="h">56 % (9/16)</TD><TD CLASS="h">60 % (3/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#20">visitFormalTypeParameter (String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD CLASS="h">62 % (5/8)</TD><TD CLASS="h">67 % (2/3)</TD></TR><TR><TD CLASS="f"><A HREF="#21">processType (String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>90 % (53/59)</TD><TD>83 % (10/12)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#1c">ReferenceExtractor$ClassFileSignatureVisitor (ReferenceExtractor): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (29/29)</TD><TD>100 % (9/9)</TD></TR><TR><TD CLASS="f"><A HREF="#23">reset (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (19/19)</TD><TD>100 % (7/7)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#24">visitArrayType (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (2/2)</TD><TD>100 % (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#25">visitClassBound (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#26">visitClassType (String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (4/4)</TD><TD>100 % (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#27">visitEnd (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (1/1)</TD><TD>100 % (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#28">visitInterface (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#29">visitInterfaceBound (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2a">visitParameterType (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (11/11)</TD><TD>100 % (3/3)</TD></TR><TR><TD CLASS="f"><A HREF="#2b">visitReturnType (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2c">visitSuperclass (): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#2d">visitTypeArgument (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (1/1)</TD><TD>100 % (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#2e">visitTypeArgument (char): SignatureVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (2/2)</TD><TD>100 % (1/1)</TD></TR><TR><TD CLASS="f"><A HREF="#2f">visitTypeVariable (String): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (1/1)</TD><TD>100 % (1/1)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#30">ReferenceExtractor</A></TD><TD>100 % (1/1)</TD><TD>91 % (20/22)</TD><TD>89 % (730/820)</TD><TD>89 % (170/191)</TD></TR><TR><TD CLASS="f"><A HREF="#31">setDebug (boolean): void</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/9)</TD><TD CLASS="h">0 %  (0/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#32">toString (): String</A></TD><TD> </TD><TD CLASS="h">0 %  (0/1)</TD><TD CLASS="h">0 %  (0/44)</TD><TD CLASS="h">0 %  (0/10)</TD></TR><TR><TD CLASS="f"><A HREF="#33">visitEnd (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD CLASS="h">56 % (14/25)</TD><TD>83 % (5/6)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#34">visit (int, int, String, String, String, String []): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>87 % (89/102)</TD><TD>95 % (20/21)</TD></TR><TR><TD CLASS="f"><A HREF="#35">addFieldReference (Type, String, int): Reference</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>89 % (17/19)</TD><TD>80 % (4/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#36">addMethodReference (Type, String, String, int): Reference</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>90 % (18/20)</TD><TD>80 % (4/5)</TD></TR><TR><TD CLASS="f"><A HREF="#37">consider (String): boolean</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>93 % (25/27)</TD><TD CLASS="h">67 % (2/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#38">consider (Reference): boolean</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>96 % (53/55)</TD><TD>92 % (11/12)</TD></TR><TR><TD CLASS="f"><A HREF="#39">visitMethod (int, String, String, String, String []): MethodVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>97 % (148/152)</TD><TD>94 % (31/33)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3a">visitInnerClass (String, String, String, int): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>99 % (75/76)</TD><TD>95 % (18/19)</TD></TR><TR><TD CLASS="f"><A HREF="#30">&lt;static initializer&gt;</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (9/9)</TD><TD>100 % (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3c">ReferenceExtractor (IApiType, Set, int): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (61/61)</TD><TD>100 % (15/15)</TD></TR><TR><TD CLASS="f"><A HREF="#3d">addReference (Reference): Reference</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (13/13)</TD><TD>100 % (4/4)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#3e">addTypeReference (Type, int): Reference</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (18/18)</TD><TD>100 % (5/5)</TD></TR><TR><TD CLASS="f"><A HREF="#3f">enterMember (IApiMember): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (6/6)</TD><TD>100 % (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#40">exitMember (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#41">getMember (): IApiMember</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (5/5)</TD><TD>100 % (1/1)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#42">processInnerClass (IApiType, int): Set</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (25/25)</TD><TD>100 % (5/5)</TD></TR><TR><TD CLASS="f"><A HREF="#43">processName (String): String</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (19/19)</TD><TD>100 % (5/5)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#44">processSignature (String, String, int, int): List</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (68/68)</TD><TD>100 % (15/15)</TD></TR><TR><TD CLASS="f"><A HREF="#45">resolveType (String): Type</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (24/24)</TD><TD>100 % (8/8)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#46">visitField (int, String, String, String, Object): FieldVisitor</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (38/38)</TD><TD>100 % (10/10)</TD></TR><TR><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD><TD CLASS="bt"> </TD></TR><TR CLASS="cis"><TD CLASS="f">class <A HREF="#47">ReferenceExtractor$LinePositionTracker</A></TD><TD>100 % (1/1)</TD><TD>100 % (6/6)</TD><TD>96 % (237/248)</TD><TD>95 % (56/59)</TD></TR><TR><TD CLASS="f"><A HREF="#48">computeLineNumbers (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>94 % (173/184)</TD><TD>93 % (41/44)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#47">ReferenceExtractor$LinePositionTracker (): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (23/23)</TD><TD>100 % (6/6)</TD></TR><TR><TD CLASS="f"><A HREF="#4a">addCatchLabelInfos (Reference, Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (10/10)</TD><TD>100 % (2/2)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4b">addLabel (Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (6/6)</TD><TD>100 % (2/2)</TD></TR><TR><TD CLASS="f"><A HREF="#4c">addLineInfo (int, Label): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (19/19)</TD><TD>100 % (3/3)</TD></TR><TR CLASS="o"><TD CLASS="f"><A HREF="#4d">addLocation (Reference): void</A></TD><TD> </TD><TD>100 % (1/1)</TD><TD>100 % (6/6)</TD><TD>100 % (2/2)</TD></TR></TABLE><P></P><TABLE CLASS="s" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="l">1</TD><TD>/*******************************************************************************</TD></TR><TR><TD CLASS="l">2</TD><TD> * Copyright (c) 2007, 2009 IBM Corporation and others.</TD></TR><TR><TD CLASS="l">3</TD><TD> * All rights reserved. This program and the accompanying materials</TD></TR><TR><TD CLASS="l">4</TD><TD> * are made available under the terms of the Eclipse Public License v1.0</TD></TR><TR><TD CLASS="l">5</TD><TD> * which accompanies this distribution, and is available at</TD></TR><TR><TD CLASS="l">6</TD><TD> * http://www.eclipse.org/legal/epl-v10.html</TD></TR><TR><TD CLASS="l">7</TD><TD> *</TD></TR><TR><TD CLASS="l">8</TD><TD> * Contributors:</TD></TR><TR><TD CLASS="l">9</TD><TD> *     IBM Corporation - initial API and implementation</TD></TR><TR><TD CLASS="l">10</TD><TD> *******************************************************************************/</TD></TR><TR><TD CLASS="l">11</TD><TD>package org.eclipse.pde.api.tools.internal.builder;</TD></TR><TR><TD CLASS="l">12</TD><TD> </TD></TR><TR><TD CLASS="l">13</TD><TD>import java.util.ArrayList;</TD></TR><TR><TD CLASS="l">14</TD><TD>import java.util.HashMap;</TD></TR><TR><TD CLASS="l">15</TD><TD>import java.util.HashSet;</TD></TR><TR><TD CLASS="l">16</TD><TD>import java.util.Iterator;</TD></TR><TR><TD CLASS="l">17</TD><TD>import java.util.List;</TD></TR><TR><TD CLASS="l">18</TD><TD>import java.util.Set;</TD></TR><TR><TD CLASS="l">19</TD><TD>import java.util.SortedSet;</TD></TR><TR><TD CLASS="l">20</TD><TD>import java.util.Stack;</TD></TR><TR><TD CLASS="l">21</TD><TD>import java.util.TreeSet;</TD></TR><TR><TD CLASS="l">22</TD><TD> </TD></TR><TR><TD CLASS="l">23</TD><TD>import org.eclipse.core.runtime.CoreException;</TD></TR><TR><TD CLASS="l">24</TD><TD>import org.eclipse.jdt.core.Signature;</TD></TR><TR><TD CLASS="l">25</TD><TD>import org.eclipse.pde.api.tools.internal.model.AbstractApiTypeRoot;</TD></TR><TR><TD CLASS="l">26</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.ApiPlugin;</TD></TR><TR><TD CLASS="l">27</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.builder.ReferenceModifiers;</TD></TR><TR><TD CLASS="l">28</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.model.IApiComponent;</TD></TR><TR><TD CLASS="l">29</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.model.IApiField;</TD></TR><TR><TD CLASS="l">30</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.model.IApiMember;</TD></TR><TR><TD CLASS="l">31</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.model.IApiMethod;</TD></TR><TR><TD CLASS="l">32</TD><TD>import org.eclipse.pde.api.tools.internal.provisional.model.IApiType;</TD></TR><TR><TD CLASS="l">33</TD><TD>import org.eclipse.pde.api.tools.internal.util.Util;</TD></TR><TR><TD CLASS="l">34</TD><TD>import org.objectweb.asm.ClassAdapter;</TD></TR><TR><TD CLASS="l">35</TD><TD>import org.objectweb.asm.ClassReader;</TD></TR><TR><TD CLASS="l">36</TD><TD>import org.objectweb.asm.FieldVisitor;</TD></TR><TR><TD CLASS="l">37</TD><TD>import org.objectweb.asm.Label;</TD></TR><TR><TD CLASS="l">38</TD><TD>import org.objectweb.asm.MethodAdapter;</TD></TR><TR><TD CLASS="l">39</TD><TD>import org.objectweb.asm.MethodVisitor;</TD></TR><TR><TD CLASS="l">40</TD><TD>import org.objectweb.asm.Opcodes;</TD></TR><TR><TD CLASS="l">41</TD><TD>import org.objectweb.asm.Type;</TD></TR><TR><TD CLASS="l">42</TD><TD>import org.objectweb.asm.signature.SignatureReader;</TD></TR><TR><TD CLASS="l">43</TD><TD>import org.objectweb.asm.signature.SignatureVisitor;</TD></TR><TR><TD CLASS="l">44</TD><TD>import org.objectweb.asm.tree.ClassNode;</TD></TR><TR><TD CLASS="l">45</TD><TD> </TD></TR><TR><TD CLASS="l">46</TD><TD>/**</TD></TR><TR><TD CLASS="l">47</TD><TD> * Extracts references from a class file</TD></TR><TR><TD CLASS="l">48</TD><TD> *</TD></TR><TR><TD CLASS="l">49</TD><TD> * @since 1.0.0</TD></TR><TR><TD CLASS="l">50</TD><TD> */</TD></TR><TR CLASS="c"><TD CLASS="l">51</TD><TD>public class ReferenceExtractor extends ClassAdapter {</TD></TR><TR><TD CLASS="l"><A NAME="30">52</A></TD><TD> </TD></TR><TR><TD CLASS="l">53</TD><TD>        /**</TD></TR><TR><TD CLASS="l">54</TD><TD>         * Constant used for controlling tracing in the visitor</TD></TR><TR><TD CLASS="l">55</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">56</TD><TD>        private static boolean DEBUG = Util.DEBUG;</TD></TR><TR><TD CLASS="l">57</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="31">58</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">59</TD><TD>         * Method used for initializing tracing in the visitor</TD></TR><TR><TD CLASS="l">60</TD><TD>         */</TD></TR><TR><TD CLASS="l">61</TD><TD>        public static void setDebug(boolean debugValue) {</TD></TR><TR CLASS="z"><TD CLASS="l">62</TD><TD>                DEBUG = debugValue || Util.DEBUG;</TD></TR><TR CLASS="z"><TD CLASS="l">63</TD><TD>        }</TD></TR><TR><TD CLASS="l">64</TD><TD> </TD></TR><TR><TD CLASS="l">65</TD><TD>        /**</TD></TR><TR><TD CLASS="l">66</TD><TD>         * A visitor for visiting java 5+ signatures</TD></TR><TR><TD CLASS="l">67</TD><TD>         * TODO this visitor does not currently visit annotations</TD></TR><TR><TD CLASS="l">68</TD><TD>         *</TD></TR><TR><TD CLASS="l">69</TD><TD>         * ClassSignature = (visitFormalTypeParameter visitClassBound? visitInterfaceBound* )* (visitSuperClass visitInterface* )</TD></TR><TR><TD CLASS="l">70</TD><TD>         * MethodSignature = (visitFormalTypeParameter visitClassBound? visitInterfaceBound* )* (visitParameterType visitReturnType visitExceptionType* )</TD></TR><TR><TD CLASS="l">71</TD><TD>         * TypeSignature = visitBaseType | visitTypeVariable | visitArrayType | (visitClassType visitTypeArgument* (visitInnerClassType visitTypeArgument* )* visitEnd&lt;/tt&gt; ) )</TD></TR><TR><TD CLASS="l">72</TD><TD>         */</TD></TR><TR><TD CLASS="l">73</TD><TD>        class ClassFileSignatureVisitor implements SignatureVisitor {</TD></TR><TR><TD CLASS="l">74</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">75</TD><TD>                protected int kind = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">76</TD><TD>                protected int originalkind = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">77</TD><TD>                protected int argumentcount = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">78</TD><TD>                protected int type = 0;</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="1c">79</A></TD><TD>                protected String signature = null;</TD></TR><TR CLASS="c"><TD CLASS="l">80</TD><TD>                protected String name = null;</TD></TR><TR><TD CLASS="l">81</TD><TD>                protected List references;</TD></TR><TR><TD CLASS="l">82</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">83</TD><TD>                public ClassFileSignatureVisitor() {</TD></TR><TR CLASS="c"><TD CLASS="l">84</TD><TD>                        this.references = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l">85</TD><TD>                }</TD></TR><TR><TD CLASS="l">86</TD><TD> </TD></TR><TR><TD CLASS="l">87</TD><TD>                /**</TD></TR><TR><TD CLASS="l">88</TD><TD>                 * Resets the visitor to its initial state.</TD></TR><TR><TD CLASS="l"><A NAME="23">89</A></TD><TD>                 * This method should be called after processing is done with the visitor</TD></TR><TR><TD CLASS="l">90</TD><TD>                 */</TD></TR><TR><TD CLASS="l">91</TD><TD>                protected void reset() {</TD></TR><TR><TD CLASS="l">92</TD><TD>                        //do not reset argument count, as it is needed once the signature visitor is done</TD></TR><TR CLASS="c"><TD CLASS="l">93</TD><TD>                        this.kind = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">94</TD><TD>                        this.originalkind = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">95</TD><TD>                        this.name = null;</TD></TR><TR CLASS="c"><TD CLASS="l">96</TD><TD>                        this.signature = null;</TD></TR><TR CLASS="c"><TD CLASS="l">97</TD><TD>                        this.type = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">98</TD><TD>                        this.references.clear();</TD></TR><TR CLASS="c"><TD CLASS="l">99</TD><TD>                }</TD></TR><TR><TD CLASS="l">100</TD><TD> </TD></TR><TR><TD CLASS="l">101</TD><TD>                /**</TD></TR><TR><TD CLASS="l">102</TD><TD>                 * Processes the type specified by the name for the current signature context.</TD></TR><TR><TD CLASS="l">103</TD><TD>                 * The kind flag is set to a parameterized type as subsequent calls to this method without visiting other nodes only occurs</TD></TR><TR><TD CLASS="l"><A NAME="21">104</A></TD><TD>                 * when we are processing parameterized types of generic declarations</TD></TR><TR><TD CLASS="l">105</TD><TD>                 * @param name the name of the type</TD></TR><TR><TD CLASS="l">106</TD><TD>                 */</TD></TR><TR><TD CLASS="l">107</TD><TD>                protected void processType(String name) {</TD></TR><TR CLASS="c"><TD CLASS="l">108</TD><TD>                        Type type = ReferenceExtractor.this.resolveType(Type.getObjectType(name).getDescriptor());</TD></TR><TR CLASS="c"><TD CLASS="l">109</TD><TD>                        if(type != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">110</TD><TD>                                String tname = type.getClassName();</TD></TR><TR CLASS="c"><TD CLASS="l">111</TD><TD>                                if(tname.equals(&#34;E&#34;) || tname.equals(&#34;T&#34;)) {  //$NON-NLS-1$//$NON-NLS-2$</TD></TR><TR CLASS="z"><TD CLASS="l">112</TD><TD>                                        type = Type.getObjectType(&#34;java.lang.Object&#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">113</TD><TD>                                        tname = type.getClassName();</TD></TR><TR><TD CLASS="l">114</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">115</TD><TD>                                if(ReferenceExtractor.this.consider(tname) &amp;&amp; this.kind != -1) {</TD></TR><TR CLASS="c"><TD CLASS="l">116</TD><TD>                                        if(this.name != null &amp;&amp; this.signature != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">117</TD><TD>                                                this.references.add(</TD></TR><TR CLASS="c"><TD CLASS="l">118</TD><TD>                                                        Reference.typeReference(ReferenceExtractor.this.getMember(), tname, this.signature, this.kind));</TD></TR><TR><TD CLASS="l">119</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">120</TD><TD>                                }</TD></TR><TR><TD CLASS="l">121</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">122</TD><TD>                        this.kind = this.originalkind;</TD></TR><TR CLASS="c"><TD CLASS="l">123</TD><TD>                }</TD></TR><TR><TD CLASS="l">124</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="26">125</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">126</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitClassType(java.lang.String)</TD></TR><TR><TD CLASS="l">127</TD><TD>                 */</TD></TR><TR><TD CLASS="l">128</TD><TD>                public void visitClassType(String name) {</TD></TR><TR CLASS="c"><TD CLASS="l">129</TD><TD>                        this.processType(name);</TD></TR><TR CLASS="c"><TD CLASS="l">130</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="20">131</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">132</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitFormalTypeParameter(java.lang.String)</TD></TR><TR><TD CLASS="l">133</TD><TD>                 */</TD></TR><TR><TD CLASS="l">134</TD><TD>                public void visitFormalTypeParameter(String name) {</TD></TR><TR CLASS="c"><TD CLASS="l">135</TD><TD>                        if(this.type != TYPE) {</TD></TR><TR CLASS="z"><TD CLASS="l">136</TD><TD>                                this.processType(name);</TD></TR><TR><TD CLASS="l">137</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">138</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2f">139</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">140</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitTypeVariable(java.lang.String)</TD></TR><TR><TD CLASS="l">141</TD><TD>                 */</TD></TR><TR><TD CLASS="l">142</TD><TD>                public void visitTypeVariable(String name) {</TD></TR><TR CLASS="c"><TD CLASS="l">143</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="1e">144</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">145</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitInnerClassType(java.lang.String)</TD></TR><TR><TD CLASS="l">146</TD><TD>                 */</TD></TR><TR><TD CLASS="l">147</TD><TD>                public void visitInnerClassType(String name) {</TD></TR><TR CLASS="z"><TD CLASS="l">148</TD><TD>                        this.processType(name);</TD></TR><TR CLASS="z"><TD CLASS="l">149</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2a">150</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">151</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitParameterType()</TD></TR><TR><TD CLASS="l">152</TD><TD>                 */</TD></TR><TR><TD CLASS="l">153</TD><TD>                public SignatureVisitor visitParameterType() {</TD></TR><TR CLASS="c"><TD CLASS="l">154</TD><TD>                        this.argumentcount++;</TD></TR><TR CLASS="c"><TD CLASS="l">155</TD><TD>                        this.kind = ReferenceModifiers.REF_PARAMETER;</TD></TR><TR CLASS="c"><TD CLASS="l">156</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">157</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="28">158</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">159</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitInterface()</TD></TR><TR><TD CLASS="l">160</TD><TD>                 */</TD></TR><TR><TD CLASS="l">161</TD><TD>                public SignatureVisitor visitInterface() {</TD></TR><TR CLASS="c"><TD CLASS="l">162</TD><TD>                        this.kind = ReferenceModifiers.REF_IMPLEMENTS;</TD></TR><TR CLASS="c"><TD CLASS="l">163</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">164</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="1d">165</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">166</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitExceptionType()</TD></TR><TR><TD CLASS="l">167</TD><TD>                 */</TD></TR><TR><TD CLASS="l">168</TD><TD>                public SignatureVisitor visitExceptionType() {</TD></TR><TR CLASS="z"><TD CLASS="l">169</TD><TD>                        this.kind = ReferenceModifiers.REF_THROWS;</TD></TR><TR CLASS="z"><TD CLASS="l">170</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">171</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="24">172</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">173</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitArrayType()</TD></TR><TR><TD CLASS="l">174</TD><TD>                 */</TD></TR><TR><TD CLASS="l">175</TD><TD>                public SignatureVisitor visitArrayType() {</TD></TR><TR CLASS="c"><TD CLASS="l">176</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">177</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2b">178</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">179</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitReturnType()</TD></TR><TR><TD CLASS="l">180</TD><TD>                 */</TD></TR><TR><TD CLASS="l">181</TD><TD>                public SignatureVisitor visitReturnType() {</TD></TR><TR CLASS="c"><TD CLASS="l">182</TD><TD>                        this.kind = ReferenceModifiers.REF_RETURNTYPE;</TD></TR><TR CLASS="c"><TD CLASS="l">183</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">184</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="25">185</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">186</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitClassBound()</TD></TR><TR><TD CLASS="l">187</TD><TD>                 */</TD></TR><TR><TD CLASS="l">188</TD><TD>                public SignatureVisitor visitClassBound() {</TD></TR><TR CLASS="c"><TD CLASS="l">189</TD><TD>                        this.kind = ReferenceModifiers.REF_PARAMETERIZED_TYPEDECL;</TD></TR><TR CLASS="c"><TD CLASS="l">190</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">191</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="29">192</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">193</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitInterfaceBound()</TD></TR><TR><TD CLASS="l">194</TD><TD>                 */</TD></TR><TR><TD CLASS="l">195</TD><TD>                public SignatureVisitor visitInterfaceBound() {</TD></TR><TR CLASS="c"><TD CLASS="l">196</TD><TD>                        this.kind = ReferenceModifiers.REF_PARAMETERIZED_TYPEDECL;</TD></TR><TR CLASS="c"><TD CLASS="l">197</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">198</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2c">199</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">200</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitSuperclass()</TD></TR><TR><TD CLASS="l">201</TD><TD>                 */</TD></TR><TR><TD CLASS="l">202</TD><TD>                public SignatureVisitor visitSuperclass() {</TD></TR><TR CLASS="c"><TD CLASS="l">203</TD><TD>                        this.kind = ReferenceModifiers.REF_EXTENDS;</TD></TR><TR CLASS="c"><TD CLASS="l">204</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l">205</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="2e">206</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">207</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitTypeArgument(char)</TD></TR><TR><TD CLASS="l">208</TD><TD>                 */</TD></TR><TR><TD CLASS="l">209</TD><TD>                public SignatureVisitor visitTypeArgument(char wildcard) {</TD></TR><TR CLASS="c"><TD CLASS="l">210</TD><TD>                        return this;</TD></TR><TR><TD CLASS="l"><A NAME="27">211</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">212</TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">213</TD><TD>                 * @see org.objectweb.asm.signature.SignatureVisitor#visitEnd()</TD></TR><TR><TD CLASS="l"><A NAME="1f">214</A></TD><TD>                 */</TD></TR><TR CLASS="c"><TD CLASS="l">215</TD><TD>                public void visitEnd() {}</TD></TR><TR><TD CLASS="l">216</TD><TD> </TD></TR><TR><TD CLASS="l">217</TD><TD>                public void visitBaseType(char descriptor) {</TD></TR><TR CLASS="c"><TD CLASS="l">218</TD><TD>                        switch(descriptor) {</TD></TR><TR><TD CLASS="l">219</TD><TD>                                case 'J' :</TD></TR><TR><TD CLASS="l">220</TD><TD>                                case 'D' :</TD></TR><TR CLASS="z"><TD CLASS="l">221</TD><TD>                                        argumentcount += 2;</TD></TR><TR CLASS="z"><TD CLASS="l">222</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l"><A NAME="2d">223</A></TD><TD>                                default :</TD></TR><TR CLASS="c"><TD CLASS="l">224</TD><TD>                                        this.argumentcount++;</TD></TR><TR><TD CLASS="l">225</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">226</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">227</TD><TD>                public void visitTypeArgument() {}</TD></TR><TR><TD CLASS="l">228</TD><TD>        }</TD></TR><TR><TD CLASS="l">229</TD><TD> </TD></TR><TR><TD CLASS="l">230</TD><TD>        /**</TD></TR><TR><TD CLASS="l">231</TD><TD>         * Visitor used to visit the methods of a type</TD></TR><TR><TD CLASS="l">232</TD><TD>         * [ visitCode ( visitFrame | visit&lt;i&gt;X&lt;/i&gt;Insn | visitLabel | visitTryCatchBlock | visitLocalVariable | visitLineNumber)* visitMaxs ] visitEnd</TD></TR><TR><TD CLASS="l">233</TD><TD>         */</TD></TR><TR><TD CLASS="l">234</TD><TD>        class ClassFileMethodVisitor extends MethodAdapter {</TD></TR><TR CLASS="c"><TD CLASS="l">235</TD><TD>                int argumentcount = 0;</TD></TR><TR><TD CLASS="l">236</TD><TD>                LinePositionTracker linePositionTracker;</TD></TR><TR><TD CLASS="l">237</TD><TD>                /**</TD></TR><TR><TD CLASS="l">238</TD><TD>                 * Most recent string literal encountered. Used to infer Class.forName(&#34;...&#34;) references.</TD></TR><TR><TD CLASS="l">239</TD><TD>                 */</TD></TR><TR><TD CLASS="l">240</TD><TD>                String stringLiteral;</TD></TR><TR><TD CLASS="l">241</TD><TD>                String methodName;</TD></TR><TR><TD CLASS="l">242</TD><TD>                int lastLineNumber;</TD></TR><TR CLASS="c"><TD CLASS="l">243</TD><TD>                boolean implicitConstructor = false;</TD></TR><TR><TD CLASS="l">244</TD><TD>                LocalLineNumberMarker localVariableMarker;</TD></TR><TR><TD CLASS="l">245</TD><TD> </TD></TR><TR><TD CLASS="l">246</TD><TD>                HashMap labelsToLocalMarkers;</TD></TR><TR><TD CLASS="l">247</TD><TD> </TD></TR><TR><TD CLASS="l">248</TD><TD>                /**</TD></TR><TR><TD CLASS="l"><A NAME="c">249</A></TD><TD>                 * Constructor</TD></TR><TR><TD CLASS="l">250</TD><TD>                 * @param mv</TD></TR><TR><TD CLASS="l">251</TD><TD>                 */</TD></TR><TR><TD CLASS="l">252</TD><TD>                public ClassFileMethodVisitor(MethodVisitor mv, String name, int argumentcount) {</TD></TR><TR CLASS="c"><TD CLASS="l">253</TD><TD>                        super(mv);</TD></TR><TR CLASS="c"><TD CLASS="l">254</TD><TD>                        this.argumentcount = argumentcount;</TD></TR><TR CLASS="c"><TD CLASS="l">255</TD><TD>                        this.linePositionTracker = new LinePositionTracker();</TD></TR><TR CLASS="c"><TD CLASS="l">256</TD><TD>                        this.lastLineNumber = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">257</TD><TD>                        this.labelsToLocalMarkers = new HashMap();</TD></TR><TR CLASS="c"><TD CLASS="l">258</TD><TD>                        this.methodName = name;</TD></TR><TR CLASS="c"><TD CLASS="l">259</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="13">260</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">261</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitEnd()</TD></TR><TR><TD CLASS="l">262</TD><TD>                 */</TD></TR><TR><TD CLASS="l">263</TD><TD>                public void visitEnd() {</TD></TR><TR CLASS="c"><TD CLASS="l">264</TD><TD>                        this.implicitConstructor = false;</TD></TR><TR CLASS="c"><TD CLASS="l">265</TD><TD>                        this.argumentcount = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">266</TD><TD>                        ReferenceExtractor.this.exitMember();</TD></TR><TR CLASS="c"><TD CLASS="l">267</TD><TD>                        this.linePositionTracker.computeLineNumbers();</TD></TR><TR CLASS="c"><TD CLASS="l">268</TD><TD>                        this.labelsToLocalMarkers = null;</TD></TR><TR CLASS="c"><TD CLASS="l">269</TD><TD>                }</TD></TR><TR><TD CLASS="l">270</TD><TD>                </TD></TR><TR><TD CLASS="l"><A NAME="1b">271</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">272</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitVarInsn(int, int)</TD></TR><TR><TD CLASS="l">273</TD><TD>                 */</TD></TR><TR><TD CLASS="l">274</TD><TD>                public void visitVarInsn(int opcode, int var) {</TD></TR><TR CLASS="c"><TD CLASS="l">275</TD><TD>                        switch(opcode) {</TD></TR><TR><TD CLASS="l">276</TD><TD>                                case Opcodes.ASTORE :</TD></TR><TR CLASS="c"><TD CLASS="l">277</TD><TD>                                        if (this.lastLineNumber != -1) {</TD></TR><TR CLASS="c"><TD CLASS="l">278</TD><TD>                                                this.localVariableMarker = new LocalLineNumberMarker(this.lastLineNumber, var);</TD></TR><TR><TD CLASS="l">279</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">280</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">281</TD><TD>                }</TD></TR><TR><TD CLASS="l">282</TD><TD>                </TD></TR><TR><TD CLASS="l"><A NAME="14">283</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">284</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitFieldInsn(int, java.lang.String, java.lang.String, java.lang.String)</TD></TR><TR><TD CLASS="l">285</TD><TD>                 */</TD></TR><TR><TD CLASS="l">286</TD><TD>                public void visitFieldInsn(int opcode, String owner, String name, String desc) {</TD></TR><TR CLASS="c"><TD CLASS="l">287</TD><TD>                        int refType = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">288</TD><TD>                        switch (opcode) {</TD></TR><TR><TD CLASS="l">289</TD><TD>                        case Opcodes.PUTSTATIC:</TD></TR><TR CLASS="c"><TD CLASS="l">290</TD><TD>                                refType = ReferenceModifiers.REF_PUTSTATIC;</TD></TR><TR CLASS="c"><TD CLASS="l">291</TD><TD>                                break;</TD></TR><TR><TD CLASS="l">292</TD><TD>                        case Opcodes.PUTFIELD:</TD></TR><TR CLASS="c"><TD CLASS="l">293</TD><TD>                                refType = ReferenceModifiers.REF_PUTFIELD;</TD></TR><TR CLASS="c"><TD CLASS="l">294</TD><TD>                                break;</TD></TR><TR><TD CLASS="l">295</TD><TD>                        case Opcodes.GETSTATIC:</TD></TR><TR CLASS="c"><TD CLASS="l">296</TD><TD>                                refType = ReferenceModifiers.REF_GETSTATIC;</TD></TR><TR CLASS="c"><TD CLASS="l">297</TD><TD>                                break;</TD></TR><TR><TD CLASS="l">298</TD><TD>                        case Opcodes.GETFIELD:</TD></TR><TR CLASS="c"><TD CLASS="l">299</TD><TD>                                refType = ReferenceModifiers.REF_GETFIELD;</TD></TR><TR><TD CLASS="l">300</TD><TD>                                break;</TD></TR><TR><TD CLASS="l">301</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">302</TD><TD>                        if (refType != -1) {</TD></TR><TR CLASS="c"><TD CLASS="l">303</TD><TD>                                Reference reference = ReferenceExtractor.this.addFieldReference(Type.getObjectType(owner), name, refType);</TD></TR><TR CLASS="c"><TD CLASS="l">304</TD><TD>                                if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">305</TD><TD>                                        this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">306</TD><TD>                                }</TD></TR><TR><TD CLASS="l">307</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">308</TD><TD>                }</TD></TR><TR><TD CLASS="l">309</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="19">310</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">311</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitTryCatchBlock(org.objectweb.asm.Label, org.objectweb.asm.Label, org.objectweb.asm.Label, java.lang.String)</TD></TR><TR><TD CLASS="l">312</TD><TD>                 */</TD></TR><TR><TD CLASS="l">313</TD><TD>                public void visitTryCatchBlock(Label start, Label end, Label handler, String type) {</TD></TR><TR CLASS="c"><TD CLASS="l">314</TD><TD>                        if(type != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">315</TD><TD>                                Type ctype = Type.getObjectType(type);</TD></TR><TR CLASS="c"><TD CLASS="l">316</TD><TD>                                Reference reference = ReferenceExtractor.this.addTypeReference(ctype, ReferenceModifiers.REF_CATCHEXCEPTION);</TD></TR><TR CLASS="c"><TD CLASS="l">317</TD><TD>                                if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">318</TD><TD>                                        this.linePositionTracker.addCatchLabelInfos(reference, handler);</TD></TR><TR CLASS="c"><TD CLASS="l">319</TD><TD>                                        this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">320</TD><TD>                                }</TD></TR><TR><TD CLASS="l">321</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">322</TD><TD>                }</TD></TR><TR><TD CLASS="l">323</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="e">324</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">325</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitLabel(Label)</TD></TR><TR><TD CLASS="l">326</TD><TD>                 */</TD></TR><TR><TD CLASS="l">327</TD><TD>                public void visitLabel(Label label) {</TD></TR><TR CLASS="c"><TD CLASS="l">328</TD><TD>                        this.linePositionTracker.addLabel(label);</TD></TR><TR CLASS="c"><TD CLASS="l">329</TD><TD>                        if (this.localVariableMarker != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">330</TD><TD>                                Object object = this.labelsToLocalMarkers.get(label);</TD></TR><TR CLASS="c"><TD CLASS="l">331</TD><TD>                                if (object != null) {</TD></TR><TR><TD CLASS="l">332</TD><TD>                                        // add in the list</TD></TR><TR CLASS="z"><TD CLASS="l">333</TD><TD>                                        if (object instanceof List) {</TD></TR><TR CLASS="z"><TD CLASS="l">334</TD><TD>                                                ((List) object).add(this.localVariableMarker);</TD></TR><TR><TD CLASS="l">335</TD><TD>                                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">336</TD><TD>                                                List list = new ArrayList();</TD></TR><TR CLASS="z"><TD CLASS="l">337</TD><TD>                                                list.add(object);</TD></TR><TR CLASS="z"><TD CLASS="l">338</TD><TD>                                                list.add(this.localVariableMarker);</TD></TR><TR CLASS="z"><TD CLASS="l">339</TD><TD>                                                this.labelsToLocalMarkers.put(label, list);</TD></TR><TR><TD CLASS="l">340</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">341</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">342</TD><TD>                                        this.labelsToLocalMarkers.put(label, this.localVariableMarker);</TD></TR><TR><TD CLASS="l">343</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">344</TD><TD>                                this.localVariableMarker = null;</TD></TR><TR><TD CLASS="l">345</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">346</TD><TD>                }</TD></TR><TR><TD CLASS="l">347</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="17">348</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">349</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitMethodInsn(int, java.lang.String, java.lang.String, java.lang.String)</TD></TR><TR><TD CLASS="l">350</TD><TD>                 */</TD></TR><TR><TD CLASS="l">351</TD><TD>                public void visitMethodInsn(int opcode, String owner, String name, String desc) {</TD></TR><TR CLASS="c"><TD CLASS="l">352</TD><TD>                        Type declaringType = Type.getObjectType(owner);</TD></TR><TR CLASS="c"><TD CLASS="l">353</TD><TD>                        int kind = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">354</TD><TD>                        switch(opcode){</TD></TR><TR><TD CLASS="l">355</TD><TD>                                case Opcodes.INVOKESPECIAL: {</TD></TR><TR CLASS="c"><TD CLASS="l">356</TD><TD>                                        kind = (&#34;&lt;init&gt;&#34;.equals(name) ? ReferenceModifiers.REF_CONSTRUCTORMETHOD : ReferenceModifiers.REF_SPECIALMETHOD); //$NON-NLS-1$</TD></TR><TR CLASS="c"><TD CLASS="l">357</TD><TD>                                        if (kind == ReferenceModifiers.REF_CONSTRUCTORMETHOD) {</TD></TR><TR CLASS="c"><TD CLASS="l">358</TD><TD>                                                if(!implicitConstructor &amp;&amp; this.methodName.equals(&#34;&lt;init&gt;&#34;) &amp;&amp; !fSuperStack.isEmpty() &amp;&amp; (fSuperStack.peek()).equals(declaringType.getClassName())) { //$NON-NLS-1$</TD></TR><TR CLASS="c"><TD CLASS="l">359</TD><TD>                                                        implicitConstructor = true;</TD></TR><TR CLASS="c"><TD CLASS="l">360</TD><TD>                                                        kind = ReferenceModifiers.REF_SUPER_CONSTRUCTORMETHOD;</TD></TR><TR><TD CLASS="l">361</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">362</TD><TD>                                                else {</TD></TR><TR CLASS="c"><TD CLASS="l">363</TD><TD>                                                        Reference reference = ReferenceExtractor.this.addTypeReference(declaringType, ReferenceModifiers.REF_INSTANTIATE);</TD></TR><TR CLASS="c"><TD CLASS="l">364</TD><TD>                                                        if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">365</TD><TD>                                                                this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">366</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">367</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">368</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">369</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">370</TD><TD>                                }</TD></TR><TR><TD CLASS="l">371</TD><TD>                                case Opcodes.INVOKESTATIC: {</TD></TR><TR CLASS="c"><TD CLASS="l">372</TD><TD>                                        kind = ReferenceModifiers.REF_STATICMETHOD;</TD></TR><TR><TD CLASS="l">373</TD><TD>                                        // check for reference to a class literal</TD></TR><TR CLASS="c"><TD CLASS="l">374</TD><TD>                                        if (name.equals(&#34;forName&#34;)) { //$NON-NLS-1$</TD></TR><TR CLASS="c"><TD CLASS="l">375</TD><TD>                                                if (ReferenceExtractor.this.processName(owner).equals(&#34;java.lang.Class&#34;)) { //$NON-NLS-1$</TD></TR><TR CLASS="c"><TD CLASS="l">376</TD><TD>                                                        if (this.stringLiteral != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">377</TD><TD>                                                                Type classLiteral = Type.getObjectType(this.stringLiteral);</TD></TR><TR CLASS="c"><TD CLASS="l">378</TD><TD>                                                                Reference reference = ReferenceExtractor.this.addTypeReference(classLiteral, ReferenceModifiers.REF_CONSTANTPOOL);</TD></TR><TR CLASS="c"><TD CLASS="l">379</TD><TD>                                                                if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">380</TD><TD>                                                                        this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">381</TD><TD>                                                                }</TD></TR><TR><TD CLASS="l">382</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">383</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">384</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">385</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">386</TD><TD>                                }</TD></TR><TR><TD CLASS="l">387</TD><TD>                                case Opcodes.INVOKEVIRTUAL: {</TD></TR><TR CLASS="c"><TD CLASS="l">388</TD><TD>                                        kind = ReferenceModifiers.REF_VIRTUALMETHOD;</TD></TR><TR CLASS="c"><TD CLASS="l">389</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">390</TD><TD>                                }</TD></TR><TR><TD CLASS="l">391</TD><TD>                                case Opcodes.INVOKEINTERFACE: {</TD></TR><TR CLASS="c"><TD CLASS="l">392</TD><TD>                                        kind = ReferenceModifiers.REF_INTERFACEMETHOD;</TD></TR><TR><TD CLASS="l">393</TD><TD>                                        break;</TD></TR><TR><TD CLASS="l">394</TD><TD>                                }</TD></TR><TR><TD CLASS="l">395</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">396</TD><TD>                        if(kind != -1) {</TD></TR><TR CLASS="c"><TD CLASS="l">397</TD><TD>                                Reference reference = ReferenceExtractor.this.addMethodReference(declaringType, name, desc, kind);</TD></TR><TR CLASS="c"><TD CLASS="l">398</TD><TD>                                if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">399</TD><TD>                                        this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">400</TD><TD>                                }</TD></TR><TR><TD CLASS="l">401</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">402</TD><TD>                        this.stringLiteral = null;</TD></TR><TR CLASS="c"><TD CLASS="l">403</TD><TD>                }</TD></TR><TR><TD CLASS="l">404</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="18">405</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">406</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitMultiANewArrayInsn(java.lang.String, int)</TD></TR><TR><TD CLASS="l">407</TD><TD>                 */</TD></TR><TR><TD CLASS="l">408</TD><TD>                public void visitMultiANewArrayInsn(String desc, int dims) {</TD></TR><TR CLASS="c"><TD CLASS="l">409</TD><TD>                        Type type = this.getTypeFromDescription(desc);</TD></TR><TR CLASS="c"><TD CLASS="l">410</TD><TD>                        Reference reference = ReferenceExtractor.this.addTypeReference(type, ReferenceModifiers.REF_ARRAYALLOC);</TD></TR><TR CLASS="c"><TD CLASS="l">411</TD><TD>                        if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">412</TD><TD>                                this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">413</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">414</TD><TD>                }</TD></TR><TR><TD CLASS="l">415</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="16">416</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">417</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitLineNumber(int, org.objectweb.asm.Label)</TD></TR><TR><TD CLASS="l">418</TD><TD>                 */</TD></TR><TR><TD CLASS="l">419</TD><TD>                public void visitLineNumber(int line, Label start) {</TD></TR><TR CLASS="c"><TD CLASS="l">420</TD><TD>                        this.lastLineNumber = line;</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="12">421</A></TD><TD>                        this.linePositionTracker.addLineInfo(line, start);</TD></TR><TR CLASS="c"><TD CLASS="l">422</TD><TD>                }</TD></TR><TR><TD CLASS="l">423</TD><TD>                </TD></TR><TR><TD CLASS="l">424</TD><TD>                public void visitCode() {</TD></TR><TR CLASS="c"><TD CLASS="l">425</TD><TD>                        super.visitCode();</TD></TR><TR CLASS="c"><TD CLASS="l">426</TD><TD>                }</TD></TR><TR><TD CLASS="l">427</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="d">428</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">429</TD><TD>                 * @see java.lang.Object#toString()</TD></TR><TR><TD CLASS="l">430</TD><TD>                 */</TD></TR><TR><TD CLASS="l">431</TD><TD>                public String toString() {</TD></TR><TR CLASS="z"><TD CLASS="l">432</TD><TD>                        StringBuffer buffer = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">433</TD><TD>                        buffer.append(&#34;Method visitor for: &#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">434</TD><TD>                        buffer.append(methodName);</TD></TR><TR CLASS="z"><TD CLASS="l">435</TD><TD>                        buffer.append(&#34;\nCurrent line number: &#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">436</TD><TD>                        buffer.append(lastLineNumber);</TD></TR><TR CLASS="z"><TD CLASS="l">437</TD><TD>                        return buffer.toString();</TD></TR><TR><TD CLASS="l">438</TD><TD>                }</TD></TR><TR><TD CLASS="l">439</TD><TD>                </TD></TR><TR><TD CLASS="l">440</TD><TD>                /**</TD></TR><TR><TD CLASS="l">441</TD><TD>                 * Creates a type from a type description. Works around bugs creating</TD></TR><TR><TD CLASS="l">442</TD><TD>                 * types from array type signatures in ASM.</TD></TR><TR><TD CLASS="l">443</TD><TD>                 *</TD></TR><TR><TD CLASS="l"><A NAME="11">444</A></TD><TD>                 * @param desc signature</TD></TR><TR><TD CLASS="l">445</TD><TD>                 * @return Type</TD></TR><TR><TD CLASS="l">446</TD><TD>                 */</TD></TR><TR><TD CLASS="l">447</TD><TD>                private Type getTypeFromDescription(String desc) {</TD></TR><TR CLASS="c"><TD CLASS="l">448</TD><TD>                        while (desc.charAt(0) == '[') {</TD></TR><TR CLASS="c"><TD CLASS="l">449</TD><TD>                                desc = desc.substring(1);</TD></TR><TR><TD CLASS="l">450</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">451</TD><TD>                        Type type = null;</TD></TR><TR CLASS="c"><TD CLASS="l">452</TD><TD>                        if (desc.length() == 1 &amp;&amp; Signature.getTypeSignatureKind(desc) == Signature.BASE_TYPE_SIGNATURE) {</TD></TR><TR CLASS="c"><TD CLASS="l">453</TD><TD>                                type = Type.getType(desc);</TD></TR><TR><TD CLASS="l">454</TD><TD>                        } else {</TD></TR><TR CLASS="c"><TD CLASS="l">455</TD><TD>                                if (desc.endsWith(&#34;;&#34;)) { //$NON-NLS-1$</TD></TR><TR CLASS="c"><TD CLASS="l">456</TD><TD>                                        type = Type.getType(desc);</TD></TR><TR><TD CLASS="l">457</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">458</TD><TD>                                        type = Type.getObjectType(desc);</TD></TR><TR><TD CLASS="l">459</TD><TD>                                }</TD></TR><TR><TD CLASS="l">460</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">461</TD><TD>                        return type;</TD></TR><TR><TD CLASS="l">462</TD><TD>                }</TD></TR><TR><TD CLASS="l"><A NAME="1a">463</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">464</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitTypeInsn(int, java.lang.String)</TD></TR><TR><TD CLASS="l">465</TD><TD>                 */</TD></TR><TR><TD CLASS="l">466</TD><TD>                public void visitTypeInsn(int opcode, String desc) {</TD></TR><TR CLASS="c"><TD CLASS="l">467</TD><TD>                        Type type = this.getTypeFromDescription(desc);</TD></TR><TR CLASS="c"><TD CLASS="l">468</TD><TD>                        if(type.getSort() == Type.OBJECT) {</TD></TR><TR CLASS="c"><TD CLASS="l">469</TD><TD>                                int kind = -1;</TD></TR><TR><TD CLASS="l">470</TD><TD>                                //we can omit the NEW case as it is caught by the constructor call</TD></TR><TR CLASS="c"><TD CLASS="l">471</TD><TD>                                switch(opcode) {</TD></TR><TR><TD CLASS="l">472</TD><TD>                                        case Opcodes.ANEWARRAY: {</TD></TR><TR CLASS="c"><TD CLASS="l">473</TD><TD>                                                kind = ReferenceModifiers.REF_ARRAYALLOC;</TD></TR><TR CLASS="c"><TD CLASS="l">474</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">475</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">476</TD><TD>                                        case Opcodes.CHECKCAST: {</TD></TR><TR CLASS="c"><TD CLASS="l">477</TD><TD>                                                kind = ReferenceModifiers.REF_CHECKCAST;</TD></TR><TR CLASS="c"><TD CLASS="l">478</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">479</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">480</TD><TD>                                        case Opcodes.INSTANCEOF: {</TD></TR><TR CLASS="c"><TD CLASS="l">481</TD><TD>                                                kind = ReferenceModifiers.REF_INSTANCEOF;</TD></TR><TR CLASS="c"><TD CLASS="l">482</TD><TD>                                                break;</TD></TR><TR><TD CLASS="l">483</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">484</TD><TD>                                        case Opcodes.NEW: {</TD></TR><TR><TD CLASS="l">485</TD><TD>                                                //handle it only for anonymous / local types</TD></TR><TR CLASS="c"><TD CLASS="l">486</TD><TD>                                                Reference ref = (Reference) fAnonymousTypes.get(processName(type.getInternalName()));</TD></TR><TR CLASS="c"><TD CLASS="l">487</TD><TD>                                                if(ref != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">488</TD><TD>                                                        this.linePositionTracker.addLocation(ref);</TD></TR><TR><TD CLASS="l">489</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">490</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">491</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">492</TD><TD>                                if(kind != -1) {</TD></TR><TR CLASS="c"><TD CLASS="l">493</TD><TD>                                        Reference reference = ReferenceExtractor.this.addTypeReference(type, kind);</TD></TR><TR CLASS="c"><TD CLASS="l">494</TD><TD>                                        if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">495</TD><TD>                                                this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">496</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">497</TD><TD>                                }</TD></TR><TR><TD CLASS="l">498</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">499</TD><TD>                }</TD></TR><TR><TD CLASS="l">500</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="f">501</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">502</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitLocalVariable(java.lang.String, java.lang.String, java.lang.String, org.objectweb.asm.Label, org.objectweb.asm.Label, int)</TD></TR><TR><TD CLASS="l">503</TD><TD>                 */</TD></TR><TR><TD CLASS="l">504</TD><TD>                public void visitLocalVariable(String name, String desc, String signature, Label start, Label end, int index) {</TD></TR><TR CLASS="c"><TD CLASS="l">505</TD><TD>                        if (desc.length() == 1) {</TD></TR><TR><TD CLASS="l">506</TD><TD>                                // base type</TD></TR><TR CLASS="c"><TD CLASS="l">507</TD><TD>                                return;</TD></TR><TR><TD CLASS="l">508</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">509</TD><TD>                        if(index &gt; this.argumentcount) {</TD></TR><TR CLASS="c"><TD CLASS="l">510</TD><TD>                                Object object = this.labelsToLocalMarkers.get(start);</TD></TR><TR CLASS="c"><TD CLASS="l">511</TD><TD>                                int lineNumber = -1;</TD></TR><TR CLASS="c"><TD CLASS="l">512</TD><TD>                                if (object != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">513</TD><TD>                                        if (object instanceof List) {</TD></TR><TR><TD CLASS="l">514</TD><TD>                                                // list of potential localMarker</TD></TR><TR><TD CLASS="l">515</TD><TD>                                                // iterate the list to find the one that matches the index</TD></TR><TR CLASS="z"><TD CLASS="l">516</TD><TD>                                                List markersList = (List) object;</TD></TR><TR CLASS="z"><TD CLASS="l">517</TD><TD>                                                LocalLineNumberMarker removeMarker = null;</TD></TR><TR CLASS="z"><TD CLASS="l">518</TD><TD>                                                loop: for(Iterator iterator = markersList.iterator(); iterator.hasNext(); ) {</TD></TR><TR CLASS="z"><TD CLASS="l">519</TD><TD>                                                        LocalLineNumberMarker marker = (LocalLineNumberMarker) iterator.next();</TD></TR><TR CLASS="z"><TD CLASS="l">520</TD><TD>                                                        if (marker.varIndex == index) {</TD></TR><TR CLASS="z"><TD CLASS="l">521</TD><TD>                                                                lineNumber = marker.lineNumber;</TD></TR><TR CLASS="z"><TD CLASS="l">522</TD><TD>                                                                removeMarker = marker;</TD></TR><TR CLASS="z"><TD CLASS="l">523</TD><TD>                                                                break loop;</TD></TR><TR><TD CLASS="l">524</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">525</TD><TD>                                                }</TD></TR><TR CLASS="z"><TD CLASS="l">526</TD><TD>                                                if (removeMarker != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">527</TD><TD>                                                        markersList.remove(removeMarker);</TD></TR><TR CLASS="z"><TD CLASS="l">528</TD><TD>                                                        if (markersList.isEmpty()) {</TD></TR><TR CLASS="z"><TD CLASS="l">529</TD><TD>                                                                this.labelsToLocalMarkers.remove(start);</TD></TR><TR><TD CLASS="l">530</TD><TD>                                                        }</TD></TR><TR><TD CLASS="l">531</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">532</TD><TD>                                        } else {</TD></TR><TR><TD CLASS="l">533</TD><TD>                                                // single marker</TD></TR><TR CLASS="c"><TD CLASS="l">534</TD><TD>                                                LocalLineNumberMarker marker = (LocalLineNumberMarker) object;</TD></TR><TR CLASS="c"><TD CLASS="l">535</TD><TD>                                                if (marker.varIndex == index) {</TD></TR><TR CLASS="c"><TD CLASS="l">536</TD><TD>                                                        lineNumber = marker.lineNumber;</TD></TR><TR CLASS="c"><TD CLASS="l">537</TD><TD>                                                        this.labelsToLocalMarkers.remove(start);</TD></TR><TR><TD CLASS="l">538</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">539</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">540</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">541</TD><TD>                                if (lineNumber == -1) return;</TD></TR><TR CLASS="c"><TD CLASS="l">542</TD><TD>                                if(signature != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">543</TD><TD>                                        List references = ReferenceExtractor.this.processSignature(name, signature, ReferenceModifiers.REF_PARAMETERIZED_VARIABLE, METHOD);</TD></TR><TR CLASS="c"><TD CLASS="l">544</TD><TD>                                        for (Iterator iterator = references.iterator(); iterator.hasNext();) {</TD></TR><TR CLASS="c"><TD CLASS="l">545</TD><TD>                                                Reference reference = (Reference) iterator.next();</TD></TR><TR CLASS="c"><TD CLASS="l">546</TD><TD>                                                reference.setLineNumber(lineNumber);</TD></TR><TR><TD CLASS="l">547</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">548</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">549</TD><TD>                                        Type type = Type.getType(desc);</TD></TR><TR CLASS="c"><TD CLASS="l">550</TD><TD>                                        if(type.getSort() == Type.OBJECT) {</TD></TR><TR CLASS="c"><TD CLASS="l">551</TD><TD>                                                Reference reference = ReferenceExtractor.this.addTypeReference(type, ReferenceModifiers.REF_LOCALVARIABLEDECL);</TD></TR><TR CLASS="c"><TD CLASS="l">552</TD><TD>                                                if (reference != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">553</TD><TD>                                                        reference.setLineNumber(lineNumber);</TD></TR><TR><TD CLASS="l">554</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">555</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">556</TD><TD>                                }</TD></TR><TR><TD CLASS="l">557</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">558</TD><TD>                }</TD></TR><TR><TD CLASS="l">559</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="15">560</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">561</TD><TD>                 * @see org.objectweb.asm.MethodAdapter#visitLdcInsn(java.lang.Object)</TD></TR><TR><TD CLASS="l">562</TD><TD>                 */</TD></TR><TR><TD CLASS="l">563</TD><TD>                public void visitLdcInsn(Object cst) {</TD></TR><TR CLASS="c"><TD CLASS="l">564</TD><TD>                        if(cst instanceof Type) {</TD></TR><TR CLASS="c"><TD CLASS="l">565</TD><TD>                                Type type = (Type) cst;</TD></TR><TR CLASS="c"><TD CLASS="l">566</TD><TD>                                Reference reference = ReferenceExtractor.this.addTypeReference(type, ReferenceModifiers.REF_CONSTANTPOOL);</TD></TR><TR CLASS="c"><TD CLASS="l">567</TD><TD>                                if (reference != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">568</TD><TD>                                        this.linePositionTracker.addLocation(reference);</TD></TR><TR><TD CLASS="l">569</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">570</TD><TD>                        } else if (cst instanceof String) {</TD></TR><TR CLASS="c"><TD CLASS="l">571</TD><TD>                                this.stringLiteral = (String) cst;</TD></TR><TR><TD CLASS="l">572</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">573</TD><TD>                }</TD></TR><TR><TD CLASS="l">574</TD><TD>                </TD></TR><TR><TD CLASS="l">575</TD><TD>                </TD></TR><TR><TD CLASS="l">576</TD><TD>        }</TD></TR><TR><TD CLASS="l">577</TD><TD> </TD></TR><TR><TD CLASS="l">578</TD><TD>        static class LinePositionTracker {</TD></TR><TR><TD CLASS="l">579</TD><TD>                List labelsAndLocations;</TD></TR><TR><TD CLASS="l"><A NAME="47">580</A></TD><TD>                SortedSet lineInfos;</TD></TR><TR><TD CLASS="l">581</TD><TD>                List catchLabelInfos;</TD></TR><TR><TD CLASS="l">582</TD><TD>                HashMap lineMap;</TD></TR><TR><TD CLASS="l">583</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">584</TD><TD>                public LinePositionTracker() {</TD></TR><TR CLASS="c"><TD CLASS="l">585</TD><TD>                        this.labelsAndLocations = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l">586</TD><TD>                        this.lineInfos = new TreeSet();</TD></TR><TR CLASS="c"><TD CLASS="l">587</TD><TD>                        this.catchLabelInfos = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="4d">588</A></TD><TD>                        this.lineMap = new HashMap();</TD></TR><TR CLASS="c"><TD CLASS="l">589</TD><TD>                }</TD></TR><TR><TD CLASS="l">590</TD><TD> </TD></TR><TR><TD CLASS="l">591</TD><TD>                void addLocation(Reference location) {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="4c">592</A></TD><TD>                        this.labelsAndLocations.add(location);</TD></TR><TR CLASS="c"><TD CLASS="l">593</TD><TD>                }</TD></TR><TR><TD CLASS="l">594</TD><TD> </TD></TR><TR><TD CLASS="l">595</TD><TD>                void addLineInfo(int line, Label label) {</TD></TR><TR CLASS="c"><TD CLASS="l">596</TD><TD>                        this.lineInfos.add(new LineInfo(line, label));</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="4a">597</A></TD><TD>                        this.lineMap.put(label, new Integer(line));</TD></TR><TR CLASS="c"><TD CLASS="l">598</TD><TD>                }</TD></TR><TR><TD CLASS="l">599</TD><TD> </TD></TR><TR><TD CLASS="l">600</TD><TD>                void addCatchLabelInfos(Reference location, Label label) {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="4b">601</A></TD><TD>                        this.catchLabelInfos.add(new LabelInfo(location, label));</TD></TR><TR CLASS="c"><TD CLASS="l">602</TD><TD>                }</TD></TR><TR><TD CLASS="l">603</TD><TD> </TD></TR><TR><TD CLASS="l">604</TD><TD>                void addLabel(Label label) {</TD></TR><TR CLASS="c"><TD CLASS="l">605</TD><TD>                        this.labelsAndLocations.add(label);</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="48">606</A></TD><TD>                }</TD></TR><TR><TD CLASS="l">607</TD><TD>                </TD></TR><TR><TD CLASS="l">608</TD><TD>                public void computeLineNumbers() {</TD></TR><TR><TD CLASS="l">609</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">610</TD><TD>                        if (this.lineInfos.size() &lt; 1 || this.labelsAndLocations.size() &lt; 1) {</TD></TR><TR><TD CLASS="l">611</TD><TD>                                // nothing to do</TD></TR><TR CLASS="z"><TD CLASS="l">612</TD><TD>                                return;</TD></TR><TR><TD CLASS="l">613</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">614</TD><TD>                        Iterator lineInfosIterator = this.lineInfos.iterator();</TD></TR><TR CLASS="c"><TD CLASS="l">615</TD><TD>                        LineInfo firstLineInfo = (LineInfo) lineInfosIterator.next();</TD></TR><TR CLASS="c"><TD CLASS="l">616</TD><TD>                        int currentLineNumber = firstLineInfo.line;</TD></TR><TR><TD CLASS="l">617</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">618</TD><TD>                        List remainingCatchLabelInfos = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l">619</TD><TD>                        for (Iterator iterator = this.catchLabelInfos.iterator(); iterator.hasNext();) {</TD></TR><TR CLASS="c"><TD CLASS="l">620</TD><TD>                                LabelInfo catchLabelInfo = (LabelInfo) iterator.next();</TD></TR><TR CLASS="c"><TD CLASS="l">621</TD><TD>                                Integer lineValue = (Integer) this.lineMap.get(catchLabelInfo.label);</TD></TR><TR CLASS="c"><TD CLASS="l">622</TD><TD>                                if (lineValue != null) {</TD></TR><TR CLASS="z"><TD CLASS="l">623</TD><TD>                                        catchLabelInfo.location.setLineNumber(lineValue.intValue());</TD></TR><TR><TD CLASS="l">624</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">625</TD><TD>                                        remainingCatchLabelInfos.add(catchLabelInfo);</TD></TR><TR><TD CLASS="l">626</TD><TD>                                }</TD></TR><TR><TD CLASS="l">627</TD><TD>                        }</TD></TR><TR><TD CLASS="l">628</TD><TD>                        // Iterate over List of Labels and SourceLocations.</TD></TR><TR CLASS="c"><TD CLASS="l">629</TD><TD>                        List computedEntries = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l">630</TD><TD>                        for (Iterator iterator = this.labelsAndLocations.iterator(); iterator.hasNext();) {</TD></TR><TR CLASS="c"><TD CLASS="l">631</TD><TD>                                Object current = iterator.next();</TD></TR><TR CLASS="c"><TD CLASS="l">632</TD><TD>                                if (current instanceof Label) {</TD></TR><TR><TD CLASS="l">633</TD><TD>                                        // label</TD></TR><TR CLASS="c"><TD CLASS="l">634</TD><TD>                                        Integer lineValue = (Integer) this.lineMap.get(current);</TD></TR><TR CLASS="c"><TD CLASS="l">635</TD><TD>                                        if (lineValue != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">636</TD><TD>                                                computedEntries.add(new LineInfo(lineValue.intValue(), (Label) current));</TD></TR><TR><TD CLASS="l">637</TD><TD>                                        } else {</TD></TR><TR CLASS="c"><TD CLASS="l">638</TD><TD>                                                computedEntries.add(current);</TD></TR><TR><TD CLASS="l">639</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">640</TD><TD>                                } else {</TD></TR><TR><TD CLASS="l">641</TD><TD>                                        // location</TD></TR><TR CLASS="c"><TD CLASS="l">642</TD><TD>                                        computedEntries.add(current);</TD></TR><TR><TD CLASS="l">643</TD><TD>                                }</TD></TR><TR><TD CLASS="l">644</TD><TD>                        }</TD></TR><TR><TD CLASS="l">645</TD><TD>                        List remaingEntriesTemp;</TD></TR><TR CLASS="c"><TD CLASS="l">646</TD><TD>                        for (Iterator iterator = computedEntries.iterator(); iterator.hasNext();) {</TD></TR><TR CLASS="c"><TD CLASS="l">647</TD><TD>                                Object current = iterator.next();</TD></TR><TR CLASS="c"><TD CLASS="l">648</TD><TD>                                if (current instanceof Label) {</TD></TR><TR><TD CLASS="l">649</TD><TD>                                        // try to set the line number for remaining catch labels</TD></TR><TR CLASS="c"><TD CLASS="l">650</TD><TD>                                        if (remainingCatchLabelInfos != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">651</TD><TD>                                                remaingEntriesTemp = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l">652</TD><TD>                                                loop: for (Iterator catchLabelInfosIterator = remainingCatchLabelInfos.iterator(); catchLabelInfosIterator.hasNext();) {</TD></TR><TR CLASS="c"><TD CLASS="l">653</TD><TD>                                                        LabelInfo catchLabelInfo = (LabelInfo) catchLabelInfosIterator.next();</TD></TR><TR CLASS="c"><TD CLASS="l">654</TD><TD>                                                        if (!current.equals(catchLabelInfo.label)) {</TD></TR><TR CLASS="c"><TD CLASS="l">655</TD><TD>                                                                remaingEntriesTemp.add(catchLabelInfo);</TD></TR><TR CLASS="c"><TD CLASS="l">656</TD><TD>                                                                continue loop;</TD></TR><TR><TD CLASS="l">657</TD><TD>                                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">658</TD><TD>                                                        catchLabelInfo.location.setLineNumber(currentLineNumber);</TD></TR><TR><TD CLASS="l">659</TD><TD>                                                }</TD></TR><TR CLASS="c"><TD CLASS="l">660</TD><TD>                                                if (remaingEntriesTemp.size() == 0) {</TD></TR><TR CLASS="c"><TD CLASS="l">661</TD><TD>                                                        remainingCatchLabelInfos = null;</TD></TR><TR><TD CLASS="l">662</TD><TD>                                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">663</TD><TD>                                                        remainingCatchLabelInfos = remaingEntriesTemp;</TD></TR><TR><TD CLASS="l">664</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">665</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">666</TD><TD>                                } else if (current instanceof Reference) {</TD></TR><TR CLASS="c"><TD CLASS="l">667</TD><TD>                                        Reference ref = (Reference) current;</TD></TR><TR CLASS="c"><TD CLASS="l">668</TD><TD>                                        if (ref.getLineNumber() == -1) {</TD></TR><TR CLASS="c"><TD CLASS="l">669</TD><TD>                                                ref.setLineNumber(currentLineNumber);</TD></TR><TR><TD CLASS="l">670</TD><TD>                                        } else {</TD></TR><TR CLASS="z"><TD CLASS="l">671</TD><TD>                                                currentLineNumber = ref.getLineNumber();</TD></TR><TR><TD CLASS="l">672</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">673</TD><TD>                                } else if (current instanceof LineInfo) {</TD></TR><TR CLASS="c"><TD CLASS="l">674</TD><TD>                                        LineInfo lineInfo = (LineInfo) current;</TD></TR><TR CLASS="c"><TD CLASS="l">675</TD><TD>                                        currentLineNumber = lineInfo.line;</TD></TR><TR><TD CLASS="l">676</TD><TD>                                }</TD></TR><TR><TD CLASS="l">677</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">678</TD><TD>                }</TD></TR><TR><TD CLASS="l">679</TD><TD>        }</TD></TR><TR><TD CLASS="l">680</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="9">681</A></TD><TD>        static class LabelInfo {</TD></TR><TR><TD CLASS="l">682</TD><TD>                public Reference location;</TD></TR><TR><TD CLASS="l">683</TD><TD>                public Label label;</TD></TR><TR><TD CLASS="l">684</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">685</TD><TD>                public LabelInfo(Reference location, Label label) {</TD></TR><TR CLASS="c"><TD CLASS="l">686</TD><TD>                        this.location = location;</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="a">687</A></TD><TD>                        this.label = label;</TD></TR><TR CLASS="c"><TD CLASS="l">688</TD><TD>                }</TD></TR><TR><TD CLASS="l">689</TD><TD> </TD></TR><TR><TD CLASS="l">690</TD><TD>                public String toString() {</TD></TR><TR CLASS="z"><TD CLASS="l">691</TD><TD>                        StringBuffer buffer = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">692</TD><TD>                        buffer.append('(').append(this.label).append(',').append(this.location).append(')');</TD></TR><TR CLASS="z"><TD CLASS="l">693</TD><TD>                        return String.valueOf(buffer);</TD></TR><TR><TD CLASS="l">694</TD><TD>                }</TD></TR><TR><TD CLASS="l">695</TD><TD>        }</TD></TR><TR><TD CLASS="l">696</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="0">697</A></TD><TD>        static class LineInfo implements Comparable {</TD></TR><TR><TD CLASS="l">698</TD><TD>                int line;</TD></TR><TR><TD CLASS="l">699</TD><TD>                Label label;</TD></TR><TR><TD CLASS="l">700</TD><TD> </TD></TR><TR CLASS="c"><TD CLASS="l">701</TD><TD>                LineInfo(int line, Label label) {</TD></TR><TR CLASS="c"><TD CLASS="l">702</TD><TD>                        this.line = line;</TD></TR><TR CLASS="c"><TD CLASS="l">703</TD><TD>                        this.label = label;</TD></TR><TR CLASS="c"><TD CLASS="l">704</TD><TD>                }</TD></TR><TR><TD CLASS="l">705</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="4">706</A></TD><TD>                /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">707</TD><TD>                 * @see java.lang.Comparable#compareTo(java.lang.Object)</TD></TR><TR><TD CLASS="l">708</TD><TD>                 */</TD></TR><TR><TD CLASS="l"><A NAME="1">709</A></TD><TD>                public int compareTo(Object o) {</TD></TR><TR CLASS="c"><TD CLASS="l">710</TD><TD>                        return this.line - ((LineInfo) o).line;</TD></TR><TR><TD CLASS="l">711</TD><TD>                }</TD></TR><TR><TD CLASS="l">712</TD><TD>                public boolean equals(Object obj) {</TD></TR><TR CLASS="z"><TD CLASS="l">713</TD><TD>                        if (obj instanceof LineInfo) {</TD></TR><TR CLASS="z"><TD CLASS="l">714</TD><TD>                                LineInfo lineInfo2 = (LineInfo) obj;</TD></TR><TR CLASS="z"><TD CLASS="l">715</TD><TD>                                return this.line == lineInfo2.line</TD></TR><TR CLASS="z"><TD CLASS="l">716</TD><TD>                                                &amp;&amp; this.label.equals(lineInfo2.label);</TD></TR><TR><TD CLASS="l"><A NAME="2">717</A></TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l">718</TD><TD>                        return super.equals(obj);</TD></TR><TR><TD CLASS="l">719</TD><TD>                }</TD></TR><TR><TD CLASS="l">720</TD><TD>                public String toString() {</TD></TR><TR CLASS="z"><TD CLASS="l">721</TD><TD>                        StringBuffer buffer = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">722</TD><TD>                        buffer.append('(').append(this.line).append(',').append(this.label).append(')');</TD></TR><TR CLASS="z"><TD CLASS="l">723</TD><TD>                        return String.valueOf(buffer);</TD></TR><TR><TD CLASS="l">724</TD><TD>                }</TD></TR><TR><TD CLASS="l">725</TD><TD>        }</TD></TR><TR><TD CLASS="l">726</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="5">727</A></TD><TD>        static class LocalLineNumberMarker {</TD></TR><TR><TD CLASS="l">728</TD><TD>                int lineNumber;</TD></TR><TR><TD CLASS="l">729</TD><TD>                int varIndex;</TD></TR><TR><TD CLASS="l">730</TD><TD>                </TD></TR><TR CLASS="c"><TD CLASS="l">731</TD><TD>                public LocalLineNumberMarker(int line, int varIndex) {</TD></TR><TR CLASS="c"><TD CLASS="l"><A NAME="6">732</A></TD><TD>                        this.lineNumber = line;</TD></TR><TR CLASS="c"><TD CLASS="l">733</TD><TD>                        this.varIndex = varIndex;</TD></TR><TR CLASS="c"><TD CLASS="l">734</TD><TD>                }</TD></TR><TR><TD CLASS="l">735</TD><TD>                public boolean equals(Object obj) {</TD></TR><TR CLASS="z"><TD CLASS="l">736</TD><TD>                        if (obj instanceof LocalLineNumberMarker) {</TD></TR><TR CLASS="z"><TD CLASS="l">737</TD><TD>                                LocalLineNumberMarker marker = (LocalLineNumberMarker) obj;</TD></TR><TR CLASS="z"><TD CLASS="l">738</TD><TD>                                return this.lineNumber == marker.lineNumber &amp;&amp; this.varIndex == marker.varIndex;</TD></TR><TR><TD CLASS="l">739</TD><TD>                        }</TD></TR><TR CLASS="z"><TD CLASS="l"><A NAME="7">740</A></TD><TD>                        return false;</TD></TR><TR><TD CLASS="l">741</TD><TD>                }</TD></TR><TR><TD CLASS="l">742</TD><TD> </TD></TR><TR><TD CLASS="l">743</TD><TD>                public int hashCode() {</TD></TR><TR CLASS="z"><TD CLASS="l">744</TD><TD>                        return this.varIndex;</TD></TR><TR><TD CLASS="l">745</TD><TD>                }</TD></TR><TR><TD CLASS="l">746</TD><TD>        }</TD></TR><TR><TD CLASS="l">747</TD><TD> </TD></TR><TR><TD CLASS="l">748</TD><TD>        /**</TD></TR><TR><TD CLASS="l">749</TD><TD>         * The list we collect references in. Entries in the list are</TD></TR><TR><TD CLASS="l">750</TD><TD>         * of the type {@link org.eclipse.pde.api.tools.internal.provisional.builder.IReference}</TD></TR><TR><TD CLASS="l">751</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">752</TD><TD>        private Set collector = null;</TD></TR><TR><TD CLASS="l">753</TD><TD>        </TD></TR><TR><TD CLASS="l">754</TD><TD>        /**</TD></TR><TR><TD CLASS="l">755</TD><TD>         * The full internal name of the class we are extracting refs from</TD></TR><TR><TD CLASS="l">756</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">757</TD><TD>        private String classname = null;</TD></TR><TR><TD CLASS="l">758</TD><TD> </TD></TR><TR><TD CLASS="l">759</TD><TD>        /**</TD></TR><TR><TD CLASS="l">760</TD><TD>         * Current type being visited.</TD></TR><TR><TD CLASS="l">761</TD><TD>         */</TD></TR><TR><TD CLASS="l">762</TD><TD>        private IApiType fType;</TD></TR><TR><TD CLASS="l">763</TD><TD> </TD></TR><TR><TD CLASS="l">764</TD><TD>        /**</TD></TR><TR><TD CLASS="l">765</TD><TD>         * Stack of members being visited. When a member is entered its</TD></TR><TR><TD CLASS="l">766</TD><TD>         * element descriptor is pushed onto the stack. When a member</TD></TR><TR><TD CLASS="l">767</TD><TD>         * is exited, the stack is popped.</TD></TR><TR><TD CLASS="l">768</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">769</TD><TD>        private Stack fMemberStack = new Stack();</TD></TR><TR><TD CLASS="l">770</TD><TD> </TD></TR><TR><TD CLASS="l">771</TD><TD>        /**</TD></TR><TR><TD CLASS="l">772</TD><TD>         * Stack of super types *names* (String) being visited. When a type is</TD></TR><TR><TD CLASS="l">773</TD><TD>         * entered, its super type is pushed onto the stack. When a type</TD></TR><TR><TD CLASS="l">774</TD><TD>         * is exited, the stack is popped.</TD></TR><TR><TD CLASS="l">775</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">776</TD><TD>        private Stack fSuperStack = new Stack();</TD></TR><TR><TD CLASS="l">777</TD><TD>        </TD></TR><TR><TD CLASS="l">778</TD><TD>        /**</TD></TR><TR><TD CLASS="l">779</TD><TD>         * Mapping of anonymous type names to their reference</TD></TR><TR><TD CLASS="l">780</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">781</TD><TD>        private HashMap fAnonymousTypes = new HashMap();</TD></TR><TR><TD CLASS="l">782</TD><TD> </TD></TR><TR><TD CLASS="l">783</TD><TD>        /**</TD></TR><TR><TD CLASS="l">784</TD><TD>         * Whether to extract references to elements within the classfile</TD></TR><TR><TD CLASS="l">785</TD><TD>         * being scanned.</TD></TR><TR><TD CLASS="l">786</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">787</TD><TD>        private boolean fIncludeLocalRefs = false;</TD></TR><TR><TD CLASS="l">788</TD><TD>        </TD></TR><TR><TD CLASS="l">789</TD><TD>        /**</TD></TR><TR><TD CLASS="l">790</TD><TD>         * Bit mask of {@link ReferenceModifiers} to extract.</TD></TR><TR><TD CLASS="l">791</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">792</TD><TD>        private int fReferenceKinds = 0;</TD></TR><TR><TD CLASS="l">793</TD><TD> </TD></TR><TR><TD CLASS="l">794</TD><TD>        /**</TD></TR><TR><TD CLASS="l">795</TD><TD>         * Bit mask that determines if we need to visit members</TD></TR><TR><TD CLASS="l">796</TD><TD>         */</TD></TR><TR><TD CLASS="l">797</TD><TD>        private static final int VISIT_MEMBERS_MASK = </TD></TR><TR><TD CLASS="l">798</TD><TD>                ReferenceModifiers.MASK_REF_ALL ^</TD></TR><TR><TD CLASS="l">799</TD><TD>                        (ReferenceModifiers.REF_EXTENDS | ReferenceModifiers.REF_IMPLEMENTS);</TD></TR><TR><TD CLASS="l">800</TD><TD>        </TD></TR><TR><TD CLASS="l">801</TD><TD>        /**</TD></TR><TR><TD CLASS="l">802</TD><TD>         * If members should be visited for type visits</TD></TR><TR><TD CLASS="l">803</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">804</TD><TD>        private boolean fIsVisitMembers = false;</TD></TR><TR><TD CLASS="l">805</TD><TD>        </TD></TR><TR><TD CLASS="l">806</TD><TD>        /**</TD></TR><TR><TD CLASS="l">807</TD><TD>         * Current field being visited, or &lt;code&gt;null&lt;/code&gt; (when</TD></TR><TR><TD CLASS="l">808</TD><TD>         * not within a field).</TD></TR><TR><TD CLASS="l">809</TD><TD>         */</TD></TR><TR CLASS="c"><TD CLASS="l">810</TD><TD>        private ClassFileSignatureVisitor signaturevisitor = new ClassFileSignatureVisitor();</TD></TR><TR CLASS="c"><TD CLASS="l">811</TD><TD>        private static int TYPE = 0, FIELD = 1, METHOD = 2;</TD></TR><TR><TD CLASS="l">812</TD><TD> </TD></TR><TR><TD CLASS="l">813</TD><TD>        /**</TD></TR><TR><TD CLASS="l">814</TD><TD>         * Constructor</TD></TR><TR><TD CLASS="l">815</TD><TD>         * @param type the type to extract references from</TD></TR><TR><TD CLASS="l"><A NAME="3c">816</A></TD><TD>         * @param collector the listing of references to annotate from this pass</TD></TR><TR><TD CLASS="l">817</TD><TD>         * @param referenceKinds kinds of references to extract as defined by {@link ReferenceModifiers}</TD></TR><TR><TD CLASS="l">818</TD><TD>         */</TD></TR><TR><TD CLASS="l">819</TD><TD>        public ReferenceExtractor(IApiType type, Set collector, int referenceKinds) {</TD></TR><TR CLASS="c"><TD CLASS="l">820</TD><TD>                super(new ClassNode());</TD></TR><TR CLASS="c"><TD CLASS="l">821</TD><TD>                fType = type;</TD></TR><TR CLASS="c"><TD CLASS="l">822</TD><TD>                this.collector = collector;</TD></TR><TR CLASS="c"><TD CLASS="l">823</TD><TD>                fReferenceKinds = referenceKinds;</TD></TR><TR CLASS="c"><TD CLASS="l">824</TD><TD>                fIsVisitMembers = (VISIT_MEMBERS_MASK &amp; fReferenceKinds) &gt; 0; </TD></TR><TR CLASS="c"><TD CLASS="l">825</TD><TD>        }</TD></TR><TR><TD CLASS="l">826</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="32">827</A></TD><TD>        /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">828</TD><TD>         * @see java.lang.Object#toString()</TD></TR><TR><TD CLASS="l">829</TD><TD>         */</TD></TR><TR><TD CLASS="l">830</TD><TD>        public String toString() {</TD></TR><TR CLASS="z"><TD CLASS="l">831</TD><TD>                StringBuffer buffer = new StringBuffer();</TD></TR><TR CLASS="z"><TD CLASS="l">832</TD><TD>                buffer.append(&#34;Reference extractor for: &#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">833</TD><TD>                buffer.append(fType.getName());</TD></TR><TR CLASS="z"><TD CLASS="l">834</TD><TD>                buffer.append(&#34;\n&#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">835</TD><TD>                buffer.append(&#34;Reference kinds: &#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">836</TD><TD>                buffer.append(Reference.getReferenceText(fReferenceKinds));</TD></TR><TR CLASS="z"><TD CLASS="l">837</TD><TD>                buffer.append(&#34;\n&#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">838</TD><TD>                buffer.append(&#34;Is visiting members: &#34;); //$NON-NLS-1$</TD></TR><TR CLASS="z"><TD CLASS="l">839</TD><TD>                buffer.append(fIsVisitMembers);</TD></TR><TR CLASS="z"><TD CLASS="l">840</TD><TD>                return buffer.toString();</TD></TR><TR><TD CLASS="l">841</TD><TD>        }</TD></TR><TR><TD CLASS="l">842</TD><TD>        </TD></TR><TR><TD CLASS="l">843</TD><TD>        /**</TD></TR><TR><TD CLASS="l">844</TD><TD>         * Returns whether to consider a reference to the specified type.</TD></TR><TR><TD CLASS="l">845</TD><TD>         * Configured by setting to include references within the same</TD></TR><TR><TD CLASS="l">846</TD><TD>         * class file.</TD></TR><TR><TD CLASS="l">847</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="37">848</A></TD><TD>         * @param owner</TD></TR><TR><TD CLASS="l">849</TD><TD>         * @return true if considered, false otherwise</TD></TR><TR><TD CLASS="l">850</TD><TD>         */</TD></TR><TR><TD CLASS="l">851</TD><TD>        protected boolean consider(String owner) {</TD></TR><TR CLASS="c"><TD CLASS="l">852</TD><TD>                if (this.fIncludeLocalRefs) {</TD></TR><TR CLASS="z"><TD CLASS="l">853</TD><TD>                        return true;</TD></TR><TR><TD CLASS="l">854</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">855</TD><TD>                return !(this.classname.equals(owner) || this.classname.startsWith(owner) || &#34;&lt;clinit&gt;&#34;.equals(owner) || &#34;this&#34;.equals(owner)); //$NON-NLS-1$ //$NON-NLS-2$</TD></TR><TR><TD CLASS="l">856</TD><TD>        }</TD></TR><TR><TD CLASS="l">857</TD><TD> </TD></TR><TR><TD CLASS="l">858</TD><TD>        /**</TD></TR><TR><TD CLASS="l">859</TD><TD>         * Returns whether the specified reference should be</TD></TR><TR><TD CLASS="l">860</TD><TD>         * considered when extracting references. Configured by setting on whether</TD></TR><TR><TD CLASS="l">861</TD><TD>         * to include references within the same class file.</TD></TR><TR><TD CLASS="l">862</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="38">863</A></TD><TD>         * @param ref reference</TD></TR><TR><TD CLASS="l">864</TD><TD>         * @return whether to include the reference</TD></TR><TR><TD CLASS="l">865</TD><TD>         */</TD></TR><TR><TD CLASS="l">866</TD><TD>        protected boolean consider(Reference ref) {</TD></TR><TR CLASS="c"><TD CLASS="l">867</TD><TD>                if ((ref.getReferenceKind() &amp; fReferenceKinds) == 0) {</TD></TR><TR CLASS="c"><TD CLASS="l">868</TD><TD>                        return false;</TD></TR><TR><TD CLASS="l">869</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">870</TD><TD>                if (this.fIncludeLocalRefs) {</TD></TR><TR CLASS="z"><TD CLASS="l">871</TD><TD>                        return true;</TD></TR><TR><TD CLASS="l">872</TD><TD>                }</TD></TR><TR><TD CLASS="l">873</TD><TD>                // don't consider references to anonymous types or elements in them</TD></TR><TR CLASS="c"><TD CLASS="l">874</TD><TD>                String referencedTypeName = ref.getReferencedTypeName();</TD></TR><TR CLASS="c"><TD CLASS="l">875</TD><TD>                if (ref.getReferenceKind() == ReferenceModifiers.REF_VIRTUALMETHOD || ref.getReferenceKind() == ReferenceModifiers.REF_OVERRIDE) {</TD></TR><TR CLASS="c"><TD CLASS="l">876</TD><TD>                        return true;</TD></TR><TR><TD CLASS="l">877</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">878</TD><TD>                if (referencedTypeName.startsWith(fType.getName())) {</TD></TR><TR><TD CLASS="l">879</TD><TD>                        // don't include references within this type or a member type</TD></TR><TR CLASS="c"><TD CLASS="l">880</TD><TD>                        if (referencedTypeName.length() &gt; fType.getName().length()) {</TD></TR><TR CLASS="c"><TD CLASS="l">881</TD><TD>                                return referencedTypeName.charAt(fType.getName().length()) != '$';</TD></TR><TR><TD CLASS="l">882</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">883</TD><TD>                        return false;</TD></TR><TR><TD CLASS="l">884</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">885</TD><TD>                return true;</TD></TR><TR><TD CLASS="l">886</TD><TD>        }</TD></TR><TR><TD CLASS="l">887</TD><TD> </TD></TR><TR><TD CLASS="l">888</TD><TD>        /**</TD></TR><TR><TD CLASS="l">889</TD><TD>         * Returns the full internal name (if available) from the given simple name.</TD></TR><TR><TD CLASS="l">890</TD><TD>         * The returned name has been modified to be '.' separated</TD></TR><TR><TD CLASS="l"><A NAME="43">891</A></TD><TD>         * @param name</TD></TR><TR><TD CLASS="l">892</TD><TD>         * @return</TD></TR><TR><TD CLASS="l">893</TD><TD>         */</TD></TR><TR><TD CLASS="l">894</TD><TD>        protected String processName(String name) {</TD></TR><TR CLASS="c"><TD CLASS="l">895</TD><TD>                String newname = name;</TD></TR><TR CLASS="c"><TD CLASS="l">896</TD><TD>                Type type = Type.getObjectType(name);</TD></TR><TR CLASS="c"><TD CLASS="l">897</TD><TD>                if(type != null &amp;&amp; type.getSort() == Type.OBJECT) {</TD></TR><TR CLASS="c"><TD CLASS="l">898</TD><TD>                        newname = type.getInternalName();</TD></TR><TR><TD CLASS="l">899</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">900</TD><TD>                return newname.replaceAll(&#34;/&#34;, &#34;.&#34;); //$NON-NLS-1$ //$NON-NLS-2$</TD></TR><TR><TD CLASS="l">901</TD><TD>        }</TD></TR><TR><TD CLASS="l">902</TD><TD> </TD></TR><TR><TD CLASS="l">903</TD><TD>        /**</TD></TR><TR><TD CLASS="l">904</TD><TD>         * Adds a reference to the given type from the current member. Discards</TD></TR><TR><TD CLASS="l">905</TD><TD>         * the reference if the type corresponds to the class file being scanned</TD></TR><TR><TD CLASS="l">906</TD><TD>         * or if the type is a primitive type.</TD></TR><TR><TD CLASS="l">907</TD><TD>         *</TD></TR><TR><TD CLASS="l">908</TD><TD>         * @param type referenced type</TD></TR><TR><TD CLASS="l">909</TD><TD>         * @param linenumber line number where referenced</TD></TR><TR><TD CLASS="l"><A NAME="3e">910</A></TD><TD>         * @param kind kind of reference</TD></TR><TR><TD CLASS="l">911</TD><TD>         * @return reference added, or &lt;code&gt;null&lt;/code&gt; if none</TD></TR><TR><TD CLASS="l">912</TD><TD>         */</TD></TR><TR><TD CLASS="l">913</TD><TD>        protected Reference addTypeReference(Type type, int kind) {</TD></TR><TR CLASS="c"><TD CLASS="l">914</TD><TD>                Type rtype = this.resolveType(type.getDescriptor());</TD></TR><TR CLASS="c"><TD CLASS="l">915</TD><TD>                if(rtype != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">916</TD><TD>                        return addReference(</TD></TR><TR CLASS="c"><TD CLASS="l">917</TD><TD>                                Reference.typeReference(getMember(), rtype.getClassName(), kind));</TD></TR><TR><TD CLASS="l">918</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">919</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">920</TD><TD>        }</TD></TR><TR><TD CLASS="l">921</TD><TD> </TD></TR><TR><TD CLASS="l">922</TD><TD>        /**</TD></TR><TR><TD CLASS="l">923</TD><TD>         * Adds a reference to the given field from the current member. Discards</TD></TR><TR><TD CLASS="l">924</TD><TD>         * the reference if the field is defined in the class file being scanned.</TD></TR><TR><TD CLASS="l">925</TD><TD>         *</TD></TR><TR><TD CLASS="l">926</TD><TD>         * @param declaringType type declaring the field being referenced</TD></TR><TR><TD CLASS="l">927</TD><TD>         * @param name of the field being referenced</TD></TR><TR><TD CLASS="l">928</TD><TD>         * @param linenumber line number where referenced</TD></TR><TR><TD CLASS="l"><A NAME="35">929</A></TD><TD>         * @param kind kind of reference</TD></TR><TR><TD CLASS="l">930</TD><TD>         * @return reference added, or &lt;code&gt;null&lt;/code&gt; if none</TD></TR><TR><TD CLASS="l">931</TD><TD>         */</TD></TR><TR><TD CLASS="l">932</TD><TD>        protected Reference addFieldReference(Type declaringType, String name, int kind) {</TD></TR><TR CLASS="c"><TD CLASS="l">933</TD><TD>                Type rtype = this.resolveType(declaringType.getDescriptor());</TD></TR><TR CLASS="c"><TD CLASS="l">934</TD><TD>                if(rtype != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">935</TD><TD>                        return addReference(</TD></TR><TR CLASS="c"><TD CLASS="l">936</TD><TD>                                Reference.fieldReference(getMember(), rtype.getClassName(), name, kind));</TD></TR><TR><TD CLASS="l">937</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">938</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">939</TD><TD>        }</TD></TR><TR><TD CLASS="l">940</TD><TD> </TD></TR><TR><TD CLASS="l">941</TD><TD>        /**</TD></TR><TR><TD CLASS="l">942</TD><TD>         * Adds a reference to the given method from the current member. Discards</TD></TR><TR><TD CLASS="l">943</TD><TD>         * the reference if the method is defined in the class file being scanned.</TD></TR><TR><TD CLASS="l">944</TD><TD>         *</TD></TR><TR><TD CLASS="l">945</TD><TD>         * @param declaringType type declaring the method (but could be a virtual lookup)</TD></TR><TR><TD CLASS="l">946</TD><TD>         * @param name of the method being referenced</TD></TR><TR><TD CLASS="l">947</TD><TD>         * @param signature signature of the method</TD></TR><TR><TD CLASS="l">948</TD><TD>         * @param linenumber line number where referenced</TD></TR><TR><TD CLASS="l"><A NAME="36">949</A></TD><TD>         * @param kind kind of reference</TD></TR><TR><TD CLASS="l">950</TD><TD>         * @return reference added, or &lt;code&gt;null&lt;/code&gt; if none</TD></TR><TR><TD CLASS="l">951</TD><TD>         */</TD></TR><TR><TD CLASS="l">952</TD><TD>        protected Reference addMethodReference(Type declaringType, String name, String signature, int kind) {</TD></TR><TR CLASS="c"><TD CLASS="l">953</TD><TD>                Type rtype = this.resolveType(declaringType.getDescriptor());</TD></TR><TR CLASS="c"><TD CLASS="l">954</TD><TD>                if(rtype != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">955</TD><TD>                        return this.addReference(</TD></TR><TR CLASS="c"><TD CLASS="l">956</TD><TD>                                        Reference.methodReference(getMember(), rtype.getClassName(), name, signature, kind));</TD></TR><TR><TD CLASS="l">957</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">958</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">959</TD><TD>        }</TD></TR><TR><TD CLASS="l">960</TD><TD> </TD></TR><TR><TD CLASS="l">961</TD><TD>        /**</TD></TR><TR><TD CLASS="l">962</TD><TD>         * Adds a reference to the given target member from the given line number</TD></TR><TR><TD CLASS="l">963</TD><TD>         * in the class file being scanned. If the target member is contained</TD></TR><TR><TD CLASS="l">964</TD><TD>         * in the class file being scanned it is discarded based on the</TD></TR><TR><TD CLASS="l">965</TD><TD>         * setting to include local references.</TD></TR><TR><TD CLASS="l">966</TD><TD>         *</TD></TR><TR><TD CLASS="l"><A NAME="3d">967</A></TD><TD>         * @param target reference</TD></TR><TR><TD CLASS="l">968</TD><TD>         * @param reference added, or &lt;code&gt;null&lt;/code&gt; if none</TD></TR><TR><TD CLASS="l">969</TD><TD>         */</TD></TR><TR><TD CLASS="l">970</TD><TD>        protected Reference addReference(Reference target) {</TD></TR><TR CLASS="c"><TD CLASS="l">971</TD><TD>                if(this.consider(target)) {</TD></TR><TR CLASS="c"><TD CLASS="l">972</TD><TD>                        this.collector.add(target);</TD></TR><TR CLASS="c"><TD CLASS="l">973</TD><TD>                        return target;</TD></TR><TR><TD CLASS="l">974</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">975</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">976</TD><TD>        }</TD></TR><TR><TD CLASS="l">977</TD><TD> </TD></TR><TR><TD CLASS="l">978</TD><TD>        /**</TD></TR><TR><TD CLASS="l">979</TD><TD>         * Processes the member signature from the specified type with the given signature and kind.</TD></TR><TR><TD CLASS="l">980</TD><TD>         * A member can be either a type, method, field or local variable</TD></TR><TR><TD CLASS="l">981</TD><TD>         *</TD></TR><TR><TD CLASS="l">982</TD><TD>         * @param name the name of the member to process</TD></TR><TR><TD CLASS="l">983</TD><TD>         * @param signature the signature of the member to process</TD></TR><TR><TD CLASS="l">984</TD><TD>         * @param kind the kind</TD></TR><TR><TD CLASS="l">985</TD><TD>         * @param type the type of member wanting to use the visitor</TD></TR><TR><TD CLASS="l"><A NAME="44">986</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">987</TD><TD>         * @return the collection of references created for this signature</TD></TR><TR><TD CLASS="l">988</TD><TD>         */</TD></TR><TR><TD CLASS="l">989</TD><TD>        protected List processSignature(String name, String signature, int kind, int type) {</TD></TR><TR CLASS="c"><TD CLASS="l">990</TD><TD>                SignatureReader reader = new SignatureReader(signature);</TD></TR><TR CLASS="c"><TD CLASS="l">991</TD><TD>                this.signaturevisitor.kind = kind;</TD></TR><TR CLASS="c"><TD CLASS="l">992</TD><TD>                this.signaturevisitor.name = this.processName(name);</TD></TR><TR CLASS="c"><TD CLASS="l">993</TD><TD>                this.signaturevisitor.signature = signature;</TD></TR><TR CLASS="c"><TD CLASS="l">994</TD><TD>                this.signaturevisitor.originalkind = kind;</TD></TR><TR CLASS="c"><TD CLASS="l">995</TD><TD>                this.signaturevisitor.argumentcount = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">996</TD><TD>                this.signaturevisitor.type = type;</TD></TR><TR CLASS="c"><TD CLASS="l">997</TD><TD>                if(kind == ReferenceModifiers.REF_PARAMETERIZED_TYPEDECL || kind == ReferenceModifiers.REF_PARAMETERIZED_METHODDECL) {</TD></TR><TR CLASS="c"><TD CLASS="l">998</TD><TD>                        reader.accept(this.signaturevisitor);</TD></TR><TR><TD CLASS="l">999</TD><TD>                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">1000</TD><TD>                        reader.acceptType(this.signaturevisitor);</TD></TR><TR><TD CLASS="l">1001</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1002</TD><TD>                List result = new ArrayList();</TD></TR><TR CLASS="c"><TD CLASS="l">1003</TD><TD>                result.addAll(this.signaturevisitor.references);</TD></TR><TR CLASS="c"><TD CLASS="l">1004</TD><TD>                this.collector.addAll(this.signaturevisitor.references);</TD></TR><TR CLASS="c"><TD CLASS="l">1005</TD><TD>                this.signaturevisitor.reset();</TD></TR><TR CLASS="c"><TD CLASS="l">1006</TD><TD>                return result;</TD></TR><TR><TD CLASS="l">1007</TD><TD>        }</TD></TR><TR><TD CLASS="l">1008</TD><TD> </TD></TR><TR><TD CLASS="l">1009</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1010</TD><TD>         * Resolves the type from the string description. This method takes only type descriptions</TD></TR><TR><TD CLASS="l">1011</TD><TD>         * as a parameter, all else will throw an exception from the ASM framework</TD></TR><TR><TD CLASS="l">1012</TD><TD>         * If the description is an array, the underlying type of the array is returned.</TD></TR><TR><TD CLASS="l"><A NAME="45">1013</A></TD><TD>         * @param desc</TD></TR><TR><TD CLASS="l">1014</TD><TD>         * @return the {@link Type} of the description or &lt;code&gt;null&lt;/code&gt;</TD></TR><TR><TD CLASS="l">1015</TD><TD>         */</TD></TR><TR><TD CLASS="l">1016</TD><TD>        protected Type resolveType(String desc) {</TD></TR><TR CLASS="c"><TD CLASS="l">1017</TD><TD>                Type type = Type.getType(desc);</TD></TR><TR CLASS="c"><TD CLASS="l">1018</TD><TD>                if(type.getSort() == Type.OBJECT) {</TD></TR><TR CLASS="c"><TD CLASS="l">1019</TD><TD>                        return type;</TD></TR><TR><TD CLASS="l">1020</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1021</TD><TD>                if(type.getSort() == Type.ARRAY) {</TD></TR><TR CLASS="c"><TD CLASS="l">1022</TD><TD>                        type = type.getElementType();</TD></TR><TR CLASS="c"><TD CLASS="l">1023</TD><TD>                        if(type.getSort() == Type.OBJECT) {</TD></TR><TR CLASS="c"><TD CLASS="l">1024</TD><TD>                                return type;</TD></TR><TR><TD CLASS="l">1025</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1026</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1027</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">1028</TD><TD>        }</TD></TR><TR><TD CLASS="l">1029</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="34">1030</A></TD><TD>        /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">1031</TD><TD>         * @see org.objectweb.asm.ClassVisitor#visit(int, int, java.lang.String, java.lang.String, java.lang.String, java.lang.String[])</TD></TR><TR><TD CLASS="l">1032</TD><TD>         */</TD></TR><TR><TD CLASS="l">1033</TD><TD>        public void visit(int version, int access, String name, String signature, String superName, String[] interfaces) {</TD></TR><TR CLASS="c"><TD CLASS="l">1034</TD><TD>                this.classname = this.processName(name);</TD></TR><TR CLASS="c"><TD CLASS="l">1035</TD><TD>                if(DEBUG) {</TD></TR><TR CLASS="z"><TD CLASS="l">1036</TD><TD>                        System.out.println(&#34;Starting visit of type: [&#34;+this.fType.getName()+&#34;]&#34;); //$NON-NLS-1$ //$NON-NLS-2$</TD></TR><TR><TD CLASS="l">1037</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1038</TD><TD>                this.enterMember(this.fType);</TD></TR><TR><TD CLASS="l">1039</TD><TD>                //if there is a signature we get more information from it, so we don't need to do both</TD></TR><TR CLASS="c"><TD CLASS="l">1040</TD><TD>                if(signature != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1041</TD><TD>                        this.processSignature(name, signature, ReferenceModifiers.REF_PARAMETERIZED_TYPEDECL, TYPE);</TD></TR><TR><TD CLASS="l">1042</TD><TD>                }</TD></TR><TR><TD CLASS="l">1043</TD><TD>                else {</TD></TR><TR CLASS="c"><TD CLASS="l">1044</TD><TD>                        if((access &amp; Opcodes.ACC_INTERFACE) != 0) {</TD></TR><TR><TD CLASS="l">1045</TD><TD>                                //the type is an interface and we need to treat the interfaces set as extends, not implements</TD></TR><TR CLASS="c"><TD CLASS="l">1046</TD><TD>                                Type supertype = null;</TD></TR><TR CLASS="c"><TD CLASS="l">1047</TD><TD>                                for(int i = 0; i &lt; interfaces.length; i++) {</TD></TR><TR CLASS="c"><TD CLASS="l">1048</TD><TD>                                        supertype = Type.getObjectType(interfaces[i]);</TD></TR><TR CLASS="c"><TD CLASS="l">1049</TD><TD>                                        this.addTypeReference(supertype, ReferenceModifiers.REF_EXTENDS);</TD></TR><TR CLASS="c"><TD CLASS="l">1050</TD><TD>                                        this.fSuperStack.add(supertype.getClassName());</TD></TR><TR><TD CLASS="l">1051</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1052</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1053</TD><TD>                        else {</TD></TR><TR CLASS="c"><TD CLASS="l">1054</TD><TD>                                Type supertype = null;</TD></TR><TR CLASS="c"><TD CLASS="l">1055</TD><TD>                                if(superName != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1056</TD><TD>                                        supertype = Type.getObjectType(superName);</TD></TR><TR CLASS="c"><TD CLASS="l">1057</TD><TD>                                        this.addTypeReference(supertype, ReferenceModifiers.REF_EXTENDS);</TD></TR><TR CLASS="c"><TD CLASS="l">1058</TD><TD>                                        this.fSuperStack.add(supertype.getClassName());</TD></TR><TR><TD CLASS="l">1059</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">1060</TD><TD>                                for(int i = 0; i &lt; interfaces.length; i++) {</TD></TR><TR CLASS="c"><TD CLASS="l">1061</TD><TD>                                        supertype = Type.getObjectType(interfaces[i]);</TD></TR><TR CLASS="c"><TD CLASS="l">1062</TD><TD>                                        this.addTypeReference(supertype, ReferenceModifiers.REF_IMPLEMENTS);</TD></TR><TR><TD CLASS="l">1063</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1064</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1065</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1066</TD><TD>        }</TD></TR><TR><TD CLASS="l">1067</TD><TD>        </TD></TR><TR><TD CLASS="l"><A NAME="33">1068</A></TD><TD>        /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">1069</TD><TD>         * @see org.objectweb.asm.ClassVisitor#visitEnd()</TD></TR><TR><TD CLASS="l">1070</TD><TD>         */</TD></TR><TR><TD CLASS="l">1071</TD><TD>        public void visitEnd() {</TD></TR><TR CLASS="c"><TD CLASS="l">1072</TD><TD>                this.exitMember();</TD></TR><TR CLASS="c"><TD CLASS="l">1073</TD><TD>                if (!this.fSuperStack.isEmpty()) {</TD></TR><TR CLASS="c"><TD CLASS="l">1074</TD><TD>                        String typeName = (String) this.fSuperStack.pop();</TD></TR><TR CLASS="c"><TD CLASS="l">1075</TD><TD>                        if(DEBUG) {</TD></TR><TR CLASS="z"><TD CLASS="l">1076</TD><TD>                                System.out.println(&#34;ending visit of type: [&#34;+typeName+&#34;]&#34;); //$NON-NLS-1$ //$NON-NLS-2$</TD></TR><TR><TD CLASS="l">1077</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1078</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1079</TD><TD>        }</TD></TR><TR><TD CLASS="l">1080</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="46">1081</A></TD><TD>        /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">1082</TD><TD>         * @see org.objectweb.asm.ClassVisitor#visitField(int, java.lang.String, java.lang.String, java.lang.String, java.lang.Object)</TD></TR><TR><TD CLASS="l">1083</TD><TD>         */</TD></TR><TR><TD CLASS="l">1084</TD><TD>        public FieldVisitor visitField(int access, String name, String desc, String signature, Object value) {</TD></TR><TR CLASS="c"><TD CLASS="l">1085</TD><TD>                if (fIsVisitMembers) {</TD></TR><TR CLASS="c"><TD CLASS="l">1086</TD><TD>                        IApiType owner = (IApiType) this.getMember();</TD></TR><TR CLASS="c"><TD CLASS="l">1087</TD><TD>                        IApiField field = owner.getField(name);</TD></TR><TR CLASS="c"><TD CLASS="l">1088</TD><TD>                        this.enterMember(field);</TD></TR><TR CLASS="c"><TD CLASS="l">1089</TD><TD>                        if((access &amp; Opcodes.ACC_SYNTHETIC) == 0) {</TD></TR><TR CLASS="c"><TD CLASS="l">1090</TD><TD>                                if(signature != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1091</TD><TD>                                        this.processSignature(name, signature, ReferenceModifiers.REF_PARAMETERIZED_FIELDDECL, FIELD);</TD></TR><TR><TD CLASS="l">1092</TD><TD>                                } else {</TD></TR><TR CLASS="c"><TD CLASS="l">1093</TD><TD>                                        this.addTypeReference(Type.getType(desc), ReferenceModifiers.REF_FIELDDECL);</TD></TR><TR><TD CLASS="l">1094</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1095</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1096</TD><TD>                        this.exitMember();</TD></TR><TR><TD CLASS="l">1097</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1098</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">1099</TD><TD>        }</TD></TR><TR><TD CLASS="l">1100</TD><TD> </TD></TR><TR><TD CLASS="l">1101</TD><TD>        /* (non-Javadoc)</TD></TR><TR><TD CLASS="l"><A NAME="3a">1102</A></TD><TD>         * @see org.objectweb.asm.ClassAdapter#visitInnerClass(java.lang.String, java.lang.String, java.lang.String, int)</TD></TR><TR><TD CLASS="l">1103</TD><TD>         */</TD></TR><TR><TD CLASS="l">1104</TD><TD>        public void visitInnerClass(String name, String outerName, String innerName, int access) {</TD></TR><TR><TD CLASS="l">1105</TD><TD>                try {</TD></TR><TR CLASS="c"><TD CLASS="l">1106</TD><TD>                        String pname = processName(name);</TD></TR><TR CLASS="c"><TD CLASS="l">1107</TD><TD>                        if(fType.getName().equals(pname) || !pname.startsWith(fType.getName())) {</TD></TR><TR CLASS="c"><TD CLASS="l">1108</TD><TD>                                return;</TD></TR><TR><TD CLASS="l">1109</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1110</TD><TD>                        IApiComponent comp = fType.getApiComponent();</TD></TR><TR CLASS="c"><TD CLASS="l">1111</TD><TD>                        if(comp == null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1112</TD><TD>                                return;</TD></TR><TR><TD CLASS="l">1113</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1114</TD><TD>                        AbstractApiTypeRoot root = (AbstractApiTypeRoot) comp.findTypeRoot(pname);</TD></TR><TR CLASS="c"><TD CLASS="l">1115</TD><TD>                        if(root != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1116</TD><TD>                                IApiType type = root.getStructure();</TD></TR><TR CLASS="c"><TD CLASS="l">1117</TD><TD>                                Set refs = null;</TD></TR><TR CLASS="c"><TD CLASS="l">1118</TD><TD>                                if(type.isAnonymous() || type.isLocal()) {</TD></TR><TR><TD CLASS="l">1119</TD><TD>                                        //visit the class files for the dependent anonymous and local inner types</TD></TR><TR CLASS="c"><TD CLASS="l">1120</TD><TD>                                        refs = processInnerClass(type, ReferenceModifiers.REF_EXTENDS);</TD></TR><TR CLASS="c"><TD CLASS="l">1121</TD><TD>                                        if(refs.iterator().hasNext()) {</TD></TR><TR CLASS="c"><TD CLASS="l">1122</TD><TD>                                                fAnonymousTypes.put(pname, refs.iterator().next());</TD></TR><TR><TD CLASS="l">1123</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1124</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1125</TD><TD>                                else {</TD></TR><TR CLASS="c"><TD CLASS="l">1126</TD><TD>                                        refs = processInnerClass(type, fReferenceKinds);</TD></TR><TR><TD CLASS="l">1127</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">1128</TD><TD>                                if(refs != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1129</TD><TD>                                        this.collector.addAll(refs);</TD></TR><TR><TD CLASS="l">1130</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1131</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1132</TD><TD>                }</TD></TR><TR CLASS="z"><TD CLASS="l">1133</TD><TD>                catch(CoreException ce) {}</TD></TR><TR CLASS="c"><TD CLASS="l">1134</TD><TD>        }</TD></TR><TR><TD CLASS="l">1135</TD><TD>        </TD></TR><TR><TD CLASS="l">1136</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1137</TD><TD>         * Processes the dependent inner class</TD></TR><TR><TD CLASS="l">1138</TD><TD>         * @param type</TD></TR><TR><TD CLASS="l">1139</TD><TD>         * @param refkinds</TD></TR><TR><TD CLASS="l"><A NAME="42">1140</A></TD><TD>         * @return</TD></TR><TR><TD CLASS="l">1141</TD><TD>         * @throws CoreException</TD></TR><TR><TD CLASS="l">1142</TD><TD>         */</TD></TR><TR><TD CLASS="l">1143</TD><TD>        private Set processInnerClass(IApiType type, int refkinds) throws CoreException {</TD></TR><TR CLASS="c"><TD CLASS="l">1144</TD><TD>                HashSet refs = new HashSet();</TD></TR><TR CLASS="c"><TD CLASS="l">1145</TD><TD>                ReferenceExtractor extractor = new ReferenceExtractor(type, refs, refkinds);</TD></TR><TR CLASS="c"><TD CLASS="l">1146</TD><TD>                ClassReader reader = new ClassReader(((AbstractApiTypeRoot)type.getTypeRoot()).getContents());</TD></TR><TR CLASS="c"><TD CLASS="l">1147</TD><TD>                reader.accept(extractor, ClassReader.SKIP_FRAMES);</TD></TR><TR CLASS="c"><TD CLASS="l">1148</TD><TD>                return refs;</TD></TR><TR><TD CLASS="l">1149</TD><TD>        }</TD></TR><TR><TD CLASS="l">1150</TD><TD>        </TD></TR><TR><TD CLASS="l"><A NAME="39">1151</A></TD><TD>        /* (non-Javadoc)</TD></TR><TR><TD CLASS="l">1152</TD><TD>         * @see org.objectweb.asm.ClassVisitor#visitMethod(int, java.lang.String, java.lang.String, java.lang.String, java.lang.String[])</TD></TR><TR><TD CLASS="l">1153</TD><TD>         */</TD></TR><TR><TD CLASS="l">1154</TD><TD>        public MethodVisitor visitMethod(int access, String name, String desc, String signature, String[] exceptions) {</TD></TR><TR CLASS="c"><TD CLASS="l">1155</TD><TD>                if (fIsVisitMembers) {</TD></TR><TR CLASS="c"><TD CLASS="l">1156</TD><TD>                        IApiMember member = this.getMember();</TD></TR><TR CLASS="c"><TD CLASS="l">1157</TD><TD>                        IApiType owner = null;</TD></TR><TR CLASS="c"><TD CLASS="l">1158</TD><TD>                        if (member instanceof IApiType) {</TD></TR><TR CLASS="c"><TD CLASS="l">1159</TD><TD>                                owner = (IApiType) member;</TD></TR><TR><TD CLASS="l">1160</TD><TD>                        } else {</TD></TR><TR><TD CLASS="l">1161</TD><TD>                                try {</TD></TR><TR CLASS="c"><TD CLASS="l">1162</TD><TD>                                        owner = member.getEnclosingType();</TD></TR><TR CLASS="z"><TD CLASS="l">1163</TD><TD>                                } catch (CoreException e) {</TD></TR><TR><TD CLASS="l">1164</TD><TD>                                        // should not happen for field or method</TD></TR><TR CLASS="z"><TD CLASS="l">1165</TD><TD>                                        ApiPlugin.log(e.getStatus());</TD></TR><TR><TD CLASS="l">1166</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1167</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1168</TD><TD>                        IApiMethod method = owner.getMethod(name, desc);</TD></TR><TR CLASS="c"><TD CLASS="l">1169</TD><TD>                        this.enterMember(method);</TD></TR><TR><TD CLASS="l">1170</TD><TD>                        // record potential method override reference</TD></TR><TR CLASS="c"><TD CLASS="l">1171</TD><TD>                        if ((access &amp; (Opcodes.ACC_PROTECTED | Opcodes.ACC_PUBLIC)) &gt; 0) {</TD></TR><TR CLASS="c"><TD CLASS="l">1172</TD><TD>                                if (!this.fSuperStack.isEmpty()) {</TD></TR><TR CLASS="c"><TD CLASS="l">1173</TD><TD>                                        String superTypeName = (String) this.fSuperStack.peek();</TD></TR><TR CLASS="c"><TD CLASS="l">1174</TD><TD>                                        addReference(</TD></TR><TR CLASS="c"><TD CLASS="l">1175</TD><TD>                                                Reference.methodReference(method, superTypeName, method.getName(), method.getSignature(), ReferenceModifiers.REF_OVERRIDE));</TD></TR><TR><TD CLASS="l">1176</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1177</TD><TD>                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1178</TD><TD>                        if((access &amp; Opcodes.ACC_SYNTHETIC) == 0 &amp;&amp; !&#34;&lt;clinit&gt;&#34;.equals(name)) { //$NON-NLS-1$</TD></TR><TR CLASS="c"><TD CLASS="l">1179</TD><TD>                                int argumentcount = 0;</TD></TR><TR CLASS="c"><TD CLASS="l">1180</TD><TD>                                if(signature != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1181</TD><TD>                                        this.processSignature(name, signature, ReferenceModifiers.REF_PARAMETERIZED_METHODDECL, METHOD);</TD></TR><TR CLASS="c"><TD CLASS="l">1182</TD><TD>                                        argumentcount = this.signaturevisitor.argumentcount;</TD></TR><TR><TD CLASS="l">1183</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1184</TD><TD>                                else {</TD></TR><TR CLASS="c"><TD CLASS="l">1185</TD><TD>                                        Type[] arguments = Type.getArgumentTypes(desc);</TD></TR><TR CLASS="c"><TD CLASS="l">1186</TD><TD>                                        for(int i = 0; i &lt; arguments.length; i++) {</TD></TR><TR CLASS="c"><TD CLASS="l">1187</TD><TD>                                                Type type = arguments[i];</TD></TR><TR CLASS="c"><TD CLASS="l">1188</TD><TD>                                                this.addTypeReference(type, ReferenceModifiers.REF_PARAMETER);</TD></TR><TR CLASS="c"><TD CLASS="l">1189</TD><TD>                                                argumentcount += type.getSize();</TD></TR><TR><TD CLASS="l">1190</TD><TD>                                        }</TD></TR><TR CLASS="c"><TD CLASS="l">1191</TD><TD>                                        this.addTypeReference(Type.getReturnType(desc), ReferenceModifiers.REF_RETURNTYPE);</TD></TR><TR CLASS="c"><TD CLASS="l">1192</TD><TD>                                        if(exceptions != null) {</TD></TR><TR CLASS="c"><TD CLASS="l">1193</TD><TD>                                                for(int i = 0; i &lt; exceptions.length; i++) {</TD></TR><TR CLASS="c"><TD CLASS="l">1194</TD><TD>                                                        this.addTypeReference(Type.getObjectType(exceptions[i]), ReferenceModifiers.REF_THROWS);</TD></TR><TR><TD CLASS="l">1195</TD><TD>                                                }</TD></TR><TR><TD CLASS="l">1196</TD><TD>                                        }</TD></TR><TR><TD CLASS="l">1197</TD><TD>                                }</TD></TR><TR CLASS="c"><TD CLASS="l">1198</TD><TD>                                MethodVisitor mv = super.visitMethod(access, name, desc, signature, exceptions);</TD></TR><TR CLASS="c"><TD CLASS="l">1199</TD><TD>                                if(mv != null &amp;&amp; ((access &amp; (Opcodes.ACC_NATIVE | Opcodes.ACC_ABSTRACT)) == 0)) {</TD></TR><TR CLASS="c"><TD CLASS="l">1200</TD><TD>                                        return new ClassFileMethodVisitor(mv, name, argumentcount);</TD></TR><TR><TD CLASS="l">1201</TD><TD>                                }</TD></TR><TR><TD CLASS="l">1202</TD><TD>                        }</TD></TR><TR><TD CLASS="l">1203</TD><TD>                }</TD></TR><TR CLASS="c"><TD CLASS="l">1204</TD><TD>                return null;</TD></TR><TR><TD CLASS="l">1205</TD><TD>        }</TD></TR><TR><TD CLASS="l">1206</TD><TD> </TD></TR><TR><TD CLASS="l">1207</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1208</TD><TD>         * Called when a member is entered. Pushes the member onto the member</TD></TR><TR><TD CLASS="l">1209</TD><TD>         * stack.</TD></TR><TR><TD CLASS="l"><A NAME="3f">1210</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1211</TD><TD>         * @param member current member</TD></TR><TR><TD CLASS="l">1212</TD><TD>         */</TD></TR><TR><TD CLASS="l">1213</TD><TD>        protected void enterMember(IApiMember member) {</TD></TR><TR CLASS="c"><TD CLASS="l">1214</TD><TD>                this.fMemberStack.push(member);</TD></TR><TR CLASS="c"><TD CLASS="l">1215</TD><TD>        }</TD></TR><TR><TD CLASS="l">1216</TD><TD> </TD></TR><TR><TD CLASS="l"><A NAME="40">1217</A></TD><TD>        /**</TD></TR><TR><TD CLASS="l">1218</TD><TD>         * Called when a member is exited. Pops the top member off the stack.</TD></TR><TR><TD CLASS="l">1219</TD><TD>         */</TD></TR><TR><TD CLASS="l">1220</TD><TD>        protected void exitMember() {</TD></TR><TR CLASS="c"><TD CLASS="l">1221</TD><TD>                this.fMemberStack.pop();</TD></TR><TR CLASS="c"><TD CLASS="l">1222</TD><TD>        }</TD></TR><TR><TD CLASS="l">1223</TD><TD> </TD></TR><TR><TD CLASS="l">1224</TD><TD>        /**</TD></TR><TR><TD CLASS="l">1225</TD><TD>         * Returns the member currently being visited.</TD></TR><TR><TD CLASS="l"><A NAME="41">1226</A></TD><TD>         *</TD></TR><TR><TD CLASS="l">1227</TD><TD>         * @return current member</TD></TR><TR><TD CLASS="l">1228</TD><TD>         */</TD></TR><TR><TD CLASS="l">1229</TD><TD>        protected IApiMember getMember() {</TD></TR><TR CLASS="c"><TD CLASS="l">1230</TD><TD>                return (IApiMember) this.fMemberStack.peek();</TD></TR><TR><TD CLASS="l">1231</TD><TD>        }</TD></TR><TR><TD CLASS="l">1232</TD><TD>}</TD></TR></TABLE><P></P><TABLE CLASS="hdft" CELLSPACING="0" WIDTH="100%"><TR><TD CLASS="nv">[<A HREF="../index.html">all classes</A>][<A HREF="9.html">org.eclipse.pde.api.tools.internal.builder</A>]</TD></TR><TR><TD CLASS="tl"><A HREF="http://www.eclemma.org/support.html">EMMA 2.0.5312 EclEmma Fix 1</A> (C) Vladimir Roubtsov</TD></TR></TABLE></BODY></HTML>